{
    "version": "https://jsonfeed.org/version/1",
    "title": "𝕺𝖚𝖗 𝕷𝖎𝖋𝖊 • All posts by \"dowork\" tag",
    "description": "记录生活 | 为众人抱薪者,不可使其扼于风雪",
    "home_page_url": "https://pangbai.work",
    "items": [
        {
            "id": "https://pangbai.work/IT/dowork/",
            "url": "https://pangbai.work/IT/dowork/",
            "title": "Dowork食用教程",
            "date_published": "2023-09-18T09:00:21.000Z",
            "content_html": "<p>Dowork 是一个在安卓运行 Linux 容器并且集成了终端，图形化显示，音频输出，容器管理等功能的多合一管理器</p>\n<span id=\"more\"></span>\n<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>如果有人用过 <code>Linuxdeploy</code> ，那必定吐槽过这玩意的难用，使用其安装 Linux，需要时刻关注天朝内部网络天气，并且准备好魔法上网，生成 <code>bootstrap</code>  的过程让人等待到厌烦，如果遇到一个包下载超时，那便只有两个选择：从头开始安装和等待 30 分钟 wget 会自动重新下载。<br />\n如果你也遇到过以下情况：用它启动 ssh 是否成功全靠运气，无法安装根文件系统，安装完成后的 Linux 残缺。那是时候考虑换个软件了。没错说的就是你 <code>Dowork</code></p>\n<h2 id=\"简单介绍\"><a class=\"anchor\" href=\"#简单介绍\">#</a> 简单介绍</h2>\n<p><code>Dowork</code>  融合了 Linuxdeploy 的后端，同时支持无 root 权限使用，在享受到 Linuxdeploy 自动脚本的方便的同时，也加入了 <code>Rootfs</code>  在线获取和下载功能，你可以通过 <code>rootfstool</code>  命令行工具获取到最新构建的发行版 Rootfs (终于不用看网络脸色了)。<br />\n <code>Dowork</code>  使用了来自 Termux 的终端，提供可控性操作，按键布局继承自 &quot;Tmoe&quot; 脚本，方便实用。<br />\n <code>Dowork</code>  使用 Xvfb 作为显示后端，提供两种显示模式 (内部 / 外部 Xvfb)，数据传输使用 unix 套接字 (比 XSDL 和 VNC 传输性能好得多), 同时支持触控会手势滚动，文本输入支持中文<br />\n <code>Dowork</code>  内置 pulseaduio, 提供音频输出。<br />\n <code>Dowork</code>  提供悬浮命令行任务输出，摸鱼和学 Linux 两不误<br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL1BhbmdCYWlXb3JrL0Rvd29yay9yZWxlYXNlcw==\">下载 Dowork (GITHUB)</span></p>\n<h2 id=\"使用教程\"><a class=\"anchor\" href=\"#使用教程\">#</a> 使用教程</h2>\n<h3 id=\"创建容器\"><a class=\"anchor\" href=\"#创建容器\">#</a> 创建容器</h3>\n<p>在容器页面点击加号即可创建<br />\n创建后请修改以下数据</p>\n<ul>\n<li>容器类型<br />\n根据是否具有 root 权限选择，若无 root 权限，只可选择 <code>proot</code></li>\n<li>发行版 GNU/Linux<br />\n 请确定自己偏好的 Linux 发行版</li>\n<li>安装类型<br />\n请选择 <code>目录</code> 安装 (其他类型暂时未适配)</li>\n<li>安装目录<br />\n此安装目录可自定义，一个容器对应一个目录<br />\n若容器为 proot, 请默认安装在 /data/data/com.pangbai.dowork/files/ 下目录<br />\n若容器为 chroot, 任何具有执行权限的目录都可安装 (最好是 /data 下目录)</li>\n</ul>\n<h3 id=\"安装rootfs\"><a class=\"anchor\" href=\"#安装rootfs\">#</a> 安装 rootfs</h3>\n<p>rootfs (根文件系统) 包含容器运行所需所有文件<br />\n Dowork 提供两种方式安装 rootfs (Proot 和 Chroot 都可以使用)</p>\n<ul>\n<li>在线构建 rootfs<br />\n 在线构建 bootstrap 与 Linuxdeploy 使用方法相同，考虑到网络状况，可能需要修改软件源<br />\n此方法较为反人类，此处略过。</li>\n<li>导入 rootfs<br />\n 返回到软件主页，点击终端符号可进入安卓 shell 环境 (此环境在容器未安装时可用)<br />\n<img data-src=\"http://shp.qpic.cn/collector/1642981619/f30928dc-b327-48ac-8303-fc235be84be8/0\" alt=\"进入终端\" /><br />\n进入终端后输入命令行，可查看 rootfstool 用法和提示</li>\n</ul>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>rootfstool <span class=\"token builtin class-name\">help</span></pre></td></tr></table></figure><p>若我们想安装最新版本的 centos9, 可输入以下命令获得 rootfs 的 url，其他发行版同理</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>rootfstool url <span class=\"token parameter variable\">-a</span> arm64 <span class=\"token parameter variable\">-d</span> centos <span class=\"token parameter variable\">-v</span> <span class=\"token number\">9</span> <span class=\"token parameter variable\">-m</span> bfsu</pre></td></tr></table></figure><p>获取到 url 后我们就可以拿去导入了，在容器配置页面，点击右上角中间的按钮，把 url 填入，进行导入，等待导入完成，提示 Succeed 即导入成功。<br />\n<img data-src=\"http://shp.qpic.cn/collector/1642981619/334ec5fb-a476-4898-92c9-e109a25f263f/0\" alt=\"导入容器\" /><br />\n此时我们返回软件主页可以看到容器的版本信息已经识别出来了<br />\n<img data-src=\"http://shp.qpic.cn/collector/1642981619/c0bbb380-7846-4bf9-8cb2-e40bd4aca7b1/0\" alt=\"版本信息\" /><br />\n是否显示版本信息是 <code>Dowork</code>  判断容器是否可用的标志<br />\n此时我们再点击终端符号，就会直接进入容器<br />\n至此容器安装完成</p>\n<h3 id=\"图形化显示以及音频输出\"><a class=\"anchor\" href=\"#图形化显示以及音频输出\">#</a> 图形化显示以及音频输出</h3>\n<ul>\n<li>图形化显示<br />\n若无特殊需求请选择内置 X 服务器，在显示页面可对显示屏幕进行设置，由于显示屏幕是横向放置，第一个参数 width 不应该大于屏幕高度，第二个参数 height 不应该大于屏幕宽度，否则会出现显示画面闪烁和崩溃，第三个参数为显示色深，如果没有特殊需求，不建议更改。更改后重启 <code>Dowork</code> ，若 Xserver 状态为 running 即正常。<br />\n <code>Dowork</code>  会自动嗅探图形化软件的打开和关闭，并且提供浮窗显示，同时可以进行点击，滚动页面等操作，如果你是一个想在安卓上进行跨平台图形化开发的开发者，你会爱上这个功能 (相比于 termux-x11 等应用，满足了开发者快速图形化调试的需求)。<br />\nDowork 已在容器内预设 DISPLAY 环境变量，只需直接启动图形化软件即可显示</li>\n<li>音频输出到 pulseaudio<br />\n 音频输出需要在容器内配置音频服务<br />\n若是 chroot 容器，可以直接在容器配置页面勾选 <code>启用允许音频输出</code> <br />\n若为 proot 容器需要手动安装软件包 (Linuxdeploy 的配置页面是为 chroot 准备的，适配需要些时间)</li>\n<li>debian 系安装 libasound2-plugins</li>\n<li>arch 系安装 pulseaudio-alsa</li>\n<li>centos 系安装 alsa-plugins-pulseaudio<br />\n 最后创建 /etc/asound.conf 文件，加入以下内容</li>\n</ul>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pcm.<span class=\"token operator\">!</span>default <span class=\"token punctuation\">&#123;</span> <span class=\"token builtin class-name\">type</span> pulse <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ctl.<span class=\"token operator\">!</span>default <span class=\"token punctuation\">&#123;</span> <span class=\"token builtin class-name\">type</span> pulse <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>pcm.pulse <span class=\"token punctuation\">&#123;</span> <span class=\"token builtin class-name\">type</span> pulse <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>ctl.pulse <span class=\"token punctuation\">&#123;</span> <span class=\"token builtin class-name\">type</span> pulse <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>至此音频配置完成<br />\n可以使用 aplay 命令测试是否成功</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>aplay *mp3</pre></td></tr></table></figure><h3 id=\"容器配置和更新仅限chroot\"><a class=\"anchor\" href=\"#容器配置和更新仅限chroot\">#</a> 容器配置和更新 (仅限 chroot)</h3>\n<p>在容器配置页面更改配置并退出<br />\n在容器管理页面点击更新按钮<br />\n<img data-src=\"http://shp.qpic.cn/collector/1642981619/9e4cd613-1b99-418e-9242-8464406f64cd/0\" alt=\"更新容器配置\" /></p>\n<h3 id=\"进程管理\"><a class=\"anchor\" href=\"#进程管理\">#</a> 进程管理</h3>\n<p>在主页会对已运行的 chroot 进程进行探测，可以进行手动管理<br />\n若点击 umount container 将会终止所有 chroot 进程并卸载容器<br />\n<img data-src=\"http://shp.qpic.cn/collector/1642981619/67a5c5ea-e46e-4934-a31e-193eee244510/0\" alt=\"进程管理\" /></p>\n",
            "tags": [
                "Dowork"
            ]
        }
    ]
}