{
    "version": "https://jsonfeed.org/version/1",
    "title": "ğ•ºğ–šğ–— ğ•·ğ–ğ–‹ğ–Š â€¢ All posts by \"android\" tag",
    "description": "è®°å½•ç”Ÿæ´» | ä¸ºä¼—äººæŠ±è–ªè€…,ä¸å¯ä½¿å…¶æ‰¼äºé£é›ª",
    "home_page_url": "https://pangbai.work",
    "items": [
        {
            "id": "https://pangbai.work/CTF/Reverse/Want2BecomeMagicalGirl/",
            "url": "https://pangbai.work/CTF/Reverse/Want2BecomeMagicalGirl/",
            "title": "Want2BecomeMagicalGirlå‡ºé¢˜ç¬”è®°-WMCTF2025",
            "date_published": "2025-10-02T08:29:00.000Z",
            "content_html": "<p>WMCTF2025 çš„å®‰å“ Reverse å‡ºé¢˜ç¬”è®°ï¼Œä½ ä¹Ÿæƒ³æˆä¸ºé­”æ³•å°‘å¥³å—ï¼Ÿé•¿æ–‡è­¦å‘Šâœ§*ï½¡Ù©(ËŠÏ‰Ë‹*)Ùˆâœ§*ï½¡</p>\n<span id=\"more\"></span>\n<p>ä½œä¸ºæœ¬æ¬¡  <code>WMCTF2025</code>  çš„  <code>Reverse</code>  é¢˜ç›®ä¹‹ä¸€ï¼Œå› ä¸ºå®³æ€•å®šä½éš¾åšçš„äººä¸å¤šï¼Œæˆ‘æŠŠæ­¤é¢˜ç›®å®šä½åœ¨ mid éš¾åº¦ï¼ˆå…¶å®æ˜¯æˆ‘ä¹Ÿä¸å¤ªç¡®å®šéš¾åº¦æï¼Œå› ä¸ºçœ‹æ‡‚äº†ä¼šå¾ˆç®€å•ï¼‰ï¼Œç›´åˆ°æ¯”èµ›ç»“æŸå‰çš„å‡Œæ™¨ 2 ç‚¹æ‰å‡ºç°äº†æœ¬é¢˜çš„å”¯ä¸€è§£ï¼ˆååˆ†æ„Ÿè°¢è¿™ä½å¸ˆå‚…ï¼‰ï¼Œè§£æ•°ä¹Ÿç®—æ˜¯é¢„æ–™ä¹‹ä¸­å§ï¼Œä¸è¿‡å±…ç„¶æˆäº†æœ¬æ¬¡è§£æœ€å°‘çš„ Re é¢˜ï¼Œæˆ‘è¿˜æ˜¯ååˆ†æƒ­æ„§çš„ã€‚é¢˜ç›®è®¾è®¡èŠ±äº†ç‚¹æ—¶é—´å¯¼è‡´ ddl å‰æ²¡æœ‰å†™ä¸€ç¯‡è¯¦ç»†çš„ WP æˆ‘ååˆ†æŠ±æ­‰ï¼Œç‰¹æ­¤å›½åº†å›æ¥å†™ä¸‹è¿™ç¯‡å‡ºé¢˜ç¬”è®°ï¼Œå¸Œæœ›èƒ½å¯¹æ„Ÿå…´è¶£çš„å¸ˆå‚…æœ‰äº›è®¸å¸®åŠ©ï¼Œå¦‚æœæœ‰ä¸è¶³ä¹‹å¤„è¿˜è¯·å¸ˆå‚…ä»¬åœ¨è¯„è®ºè¡¥å……ï¼Œååˆ†æ„Ÿè°¢ã€‚</p>\n<h3 id=\"å½©è›‹éƒ¨åˆ†\"><a class=\"anchor\" href=\"#å½©è›‹éƒ¨åˆ†\">#</a> å½©è›‹éƒ¨åˆ†</h3>\n<p>æœ¬æ¬¡é¢˜ç›®è®¾è®¡äº†ä¸€ä¸ªå°å½©è›‹ï¼Œåšé¢˜çš„å¸ˆå‚…ä»¬æœ‰æ²¡æœ‰å‘ç°äº†å—ï¼ŸApk å®‰è£…åå°±ä¼šå‡ºç°ä¸€æ•´ä¸ªæ¡Œé¢çš„é­”æ³•å°‘å¥³å›¾æ ‡å¹¶ä¸”æœ‰ä¸åŒçš„è¯­å½•ï¼Œä¸ç®¡ç‚¹å“ªä¸€ä¸ªå›¾æ ‡éƒ½æ˜¯å¯ä»¥è¿›å…¥åˆ°é¢˜ç›®é¡µé¢çš„ï¼Œé€šè¿‡ä»»ä½•ä¸€ä¸ªå›¾æ ‡å¸è½½ç¨‹åºå…¨éƒ¨å›¾æ ‡éƒ½ä¼šæ¶ˆå¤±ã€‚<br />\n<img data-src=\"d1a4cd30c81bde3dc4fbc8fbc16afffc.jpeg\" alt=\"alt text\" /><br />\n å¤šå›¾æ ‡åªè¦åœ¨å£°æ˜ activity çš„æ—¶å€™ä¸ºæ¯ä¸ª activity åŠ ä¸Šä»¥ä¸‹æ ‡ç­¾å°±è¡Œäº†</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>intent-filter</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>action</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android.intent.action.MAIN<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>category</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>intent-filter</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>æ¯”å¦‚</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>activity</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>theme</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@style/LaunchTheme<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>label</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Want2BecomeMagicalGirl<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>icon</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@drawable/magical_girl<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>work.pangbai.magic.magical_girl.MainActivity<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>exported</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>launchMode</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>singleTop<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>configChanges</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>fontScale|layoutDirection|density|smallestScreenSize|screenSize|uiMode|screenLayout|orientation|keyboardHidden|keyboard|locale<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>windowSoftInputMode</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>adjustResize<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>hardwareAccelerated</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta-data</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>io.flutter.embedding.android.NormalTheme<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>resource</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@style/NormalTheme<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>intent-filter</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>action</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android.intent.action.MAIN<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>category</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>intent-filter</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>activity</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>activity</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>label</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>My magic is stronger than your darkness!<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>icon</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@drawable/magical_girl<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>work.pangbai.magic.magical_girl.MainActivity1<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>exported</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>intent-filter</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>action</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android.intent.action.MAIN<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>category</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>intent-filter</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>activity</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>activity</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>label</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>In the name of the Moon, I<span class=\"token entity named-entity\" title=\"&apos;\">&amp;apos;</span>ll punish you!<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>icon</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@drawable/magical_girl<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>work.pangbai.magic.magical_girl.MainActivity2<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>exported</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>intent-filter</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>action</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android.intent.action.MAIN<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>category</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>intent-filter</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>activity</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>activity</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>label</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Love and justice! Pretty sailor-suited soldier, Sailor Moon!<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>icon</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@drawable/magical_girl<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>work.pangbai.magic.magical_girl.MainActivity3<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>            <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>exported</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>intent-filter</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>action</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android.intent.action.MAIN<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>category</span> <span class=\"token attr-name\"><span class=\"token namespace\">android:</span>name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android.intent.category.LAUNCHER<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>intent-filter</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>activity</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>éä¸» Activity çš„æ¯ä¸ª Activity ç”³æ˜ä¸€ä¸ªç±»ä¸å†™ä»»ä½•å®ç°ï¼Œå°±åƒè¿™æ ·</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">package</span> <span class=\"token namespace\">work<span class=\"token punctuation\">.</span>pangbai<span class=\"token punctuation\">.</span>magic<span class=\"token punctuation\">.</span>magical_girl</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MainActivity1</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">MainActivity</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>å†å¤åˆ¶å‡ ä¸ª Activity ä¹‹åä¸ç®¡ç‚¹å‡»å“ªä¸ªå›¾æ ‡è°ƒè½¬éƒ½ä¼šæ˜¯ç¬¬ä¸€ä¸ª MainActivityï¼Œè¿™æ ·å°±å®ç°äº†å¤šå›¾æ ‡çš„æ•ˆæœï¼Œååˆ†æœ‰è¶£ã€‚</p>\n<h3 id=\"é¢˜ç›®æ¶æ„\"><a class=\"anchor\" href=\"#é¢˜ç›®æ¶æ„\">#</a> é¢˜ç›®æ¶æ„</h3>\n<p>é¢˜ç›®ä½¿ç”¨ <code>flutter + native + Java</code>  å®ç°ï¼Œå¤šå°‘æœ‰ç‚¹èŠ±å“¨ä½†æ˜¯æµç¨‹è¿˜æ˜¯å¾ˆæ¸…æ™°çš„ï¼š  <code>Flutterè¾“å…¥-&gt;åŠ è½½libnative.so-&gt;ä¿®æ”¹å­—èŠ‚ç -&gt;åˆ¤æ–­libart.soæŒ‡å®šä½ç½®æœ‰æ²¡æœ‰è¢«ä¿®æ”¹-&gt;é­”æ”¹aesåŠ å¯†-&gt;é­”æ”¹JavaåŠ å¯†-&gt;Flutteråˆ¤æ–­å¯†æ–‡</code> ï¼Œæ•´ä¸ªç¨‹åºåªæ¶‰åŠåˆ° AES å’Œ XXTEA åŠ å¯†ï¼Œå…¶å®æœ€æ ¸å¿ƒçš„éƒ¨åˆ†æ˜¯å¯¹  <code>Java</code>  å±‚ä»£ç çš„é­”æ”¹ã€‚</p>\n<h3 id=\"flutteréƒ¨åˆ†\"><a class=\"anchor\" href=\"#flutteréƒ¨åˆ†\">#</a> Flutter éƒ¨åˆ†</h3>\n<p>ç¬¬ä¸€éƒ¨åˆ†åœ¨æ¯”èµ›è¿›è¡Œçš„è¿‡ç¨‹ä¸­å°±éš¾å€’äº†è®¸å¤šå¸ˆå‚…ï¼Œ <code>Flutter</code>  æ¡†æ¶å†™çš„é¢˜ç›®åœ¨å›½å†… CTF æ¯”èµ›ä¸­ä¸ç®—å¸¸è§ï¼Œä½†æ˜¯ç¡®å®ä¹Ÿå‡ºç°è¿‡ä¸å°‘æ¬¡äº†ï¼Œæ¯”å¦‚ NepCTF2025ï¼ŒNKCTF2024ï¼ŒNewStarCTF2024 ç­‰ç­‰ã€‚è¿™é‡Œé€†å‘ç”¨åˆ°äº†é¡¹ç›® <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3dvcmF3aXQvYmx1dHRlcg==\">blutter</span> ã€‚<br />\næˆ‘æ¨èé™æ€åˆ†æä» <code>blutter</code>  ç”Ÿæˆçš„ <code>asm</code>  å¼€å§‹å…¥æ‰‹ï¼Œå› ä¸ºè¿™é‡Œå­˜åœ¨å¤§éƒ¨åˆ†ä»£ç ç»“æ„å’Œé€»è¾‘ï¼ˆå‡ ä¹å…¨éƒ¨é€»è¾‘ï¼‰ï¼Œè€Œä¸”åŒ IDA åˆ†æçš„å‡ºçš„ä¼ª C ä»£ç ä¸åŒï¼Œè¿™é‡Œçš„ç±»å’Œå‡½æ•°æ˜¯æœ€æ¸…æ™°çš„ï¼Œå„ç§é—­åŒ…çš„è°ƒç”¨å’Œå­—ç¬¦ä¸²å¸¸é‡æ›´æ˜¯æ¸…æ™°å¯è§ (åœ¨ IDA ä¸­é—­åŒ…å¯èƒ½æ˜¯å„ç§å„æ ·éƒ½åŸºå€ + åç§»è°ƒç”¨)ï¼ŒIDA åªé€‚åˆåœ¨ Hook å’Œè°ƒè¯•æ—¶ä½¿ç”¨ã€‚<br />\n <code>blutter</code>  ä¼šç”Ÿæˆ <code>asm/magical_girl</code>  æ–‡ä»¶å¤¹ä¸‹å­˜åœ¨ä»¥ä¸‹æ–‡ä»¶</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>ç›®å½•: D:<span class=\"token punctuation\">\\</span>share<span class=\"token punctuation\">\\</span>å‡ºé¢˜<span class=\"token punctuation\">\\</span>WMCTF<span class=\"token punctuation\">\\</span>lib<span class=\"token punctuation\">\\</span>output<span class=\"token punctuation\">\\</span>asm<span class=\"token punctuation\">\\</span>magical_girl</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Mode                 LastWriteTime         Length Name</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>----                 -------------         ------ ----</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>-a----         <span class=\"token number\">2025</span>/10/3     <span class=\"token number\">17</span>:52         <span class=\"token number\">441492</span> aes_crypt_null_safe.dart</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>-a----         <span class=\"token number\">2025</span>/10/3     <span class=\"token number\">17</span>:52          <span class=\"token number\">70967</span> EditView.dart</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>-a----         <span class=\"token number\">2025</span>/10/3     <span class=\"token number\">17</span>:52          <span class=\"token number\">30221</span> main.dart</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>-a----         <span class=\"token number\">2025</span>/10/3     <span class=\"token number\">17</span>:52           <span class=\"token number\">3717</span> null_sub0.dart</pre></td></tr></table></figure><p>ä»…ä»åšé¢˜è€…çš„è§’åº¦å‡ºå‘ï¼Œä»£ç  <code>EditView.dart</code>  çš„ <code>check</code>  å‡½æ•°å°±æ˜¯ <code>flutter</code>  å±‚çš„ <code>check</code>  é€»è¾‘ã€‚<br />\n <code>blutter</code>  æ˜¯å¾ˆä¼˜ç§€çš„å·¥å…·ï¼Œä½†æ˜¯ä»£ç ä¸­å¤¹æ‚å¤§é‡ä¸å­˜åœ¨é«˜äº®çš„ <code>ARM</code>  æ±‡ç¼–ï¼Œé˜…è¯»è¿˜æ˜¯ååˆ†å¤´ç–¼çš„ï¼Œåœ¨ <code>ai</code>  å…´èµ·çš„è¿™ä¸ªæ—¶ä»£é è‚‰çœ¼åˆ†æè¿˜æ˜¯å¤ªè¿‡è½åäº†ï¼Œè¿™é‡Œæˆ‘å€ŸåŠ© <code>ai agent</code>  æ¥å¿«é€Ÿåˆ†æä»£ç ï¼ˆæ³¨æ„ <code>ai</code>  å¹¶ä¸å®Œå…¨å¯ä¿¡ç»†èŠ‚éƒ¨åˆ†ä»»ç„¶éœ€è¦è‡ªå·±å®¡æŸ¥ï¼‰ã€‚</p>\n<figure class=\"highlight dart\"><figcaption data-lang=\"dart\"><span>EditView.dart</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// lib: package:magical_girl/EditView.dart</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// é‡æ–°åˆ†æåçš„æ­£ç¡®è¿˜åŸä»£ç </span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token string-literal\"><span class=\"token string\">'package:flutter/material.dart'</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token string-literal\"><span class=\"token string\">'package:flutter/services.dart'</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token string-literal\"><span class=\"token string\">'dart:convert'</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token string-literal\"><span class=\"token string\">'dart:typed_data'</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token string-literal\"><span class=\"token string\">'package:magical_girl/aes_crypt_null_safe.dart'</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token string-literal\"><span class=\"token string\">'package:magical_girl/null_sub0.dart'</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token string-literal\"><span class=\"token string\">'package:native_add/native_add.dart'</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyEditTextState</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">State</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">dynamic</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  late <span class=\"token class-name\">TextEditingController</span> _textController<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  late <span class=\"token class-name\">String</span> _displayText<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  late <span class=\"token keyword\">dynamic</span> _symmetricKey<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token metadata function\">@override</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token keyword\">void</span> <span class=\"token function\">initState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">initState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    _textController <span class=\"token operator\">=</span> <span class=\"token class-name\">TextEditingController</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    _displayText <span class=\"token operator\">=</span> <span class=\"token string-literal\"><span class=\"token string\">\"\"\"é­”æ³•ã§æœ€ä½ãªäººã‚’æ¶ˆãã†</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>Let's use magic to erase the worst people</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>ç”¨é­”æ³•å°†æ¶äººå…¨éƒ¨æŠ¹æ¶ˆ</pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>ã¯ãæ­£ç›´ã‚‚ã†ã‚„ã‚ãŸã„ï¼ˆã¯ãï¼‰</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>Sigh... Honestly I want to quit sigh</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>å”‰ è¯´çœŸçš„å·²ç»ç´¯äº†ï¼ˆå”‰ï¼‰</pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>é­”æ³•å°‘å¥³ã‚’ã‚„ã‚ãŸã„ï¼ˆã¯ãï¼‰</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>I want to stop being a magical girl sigh</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>ä¸æƒ³å†å½“é­”æ³•å°‘å¥³äº†ï¼ˆå”‰ï¼‰</pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>è‡ªåˆ†ã”ã¨æ¶ˆãˆã¡ã‚ƒã£ã¦ã•ã‚ˆã†ãªã‚‰</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>Maybe I should disappear myself - goodbye</pre></td></tr><tr><td data-num=\"35\"></td><td><pre>è¿åŒè‡ªå·±ä¹Ÿä¸€èµ·æŠ¹é™¤ æ°¸åˆ«äº†\"\"\"</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>  <span class=\"token metadata function\">@override</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>  <span class=\"token class-name\">Widget</span> <span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BuildContext</span> context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token class-name\">Scaffold</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>      appBar<span class=\"token punctuation\">:</span> <span class=\"token class-name\">AppBar</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        title<span class=\"token punctuation\">:</span> <span class=\"token keyword\">const</span> <span class=\"token class-name\">Text</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>          <span class=\"token string-literal\"><span class=\"token string\">\"Want2BecomeMagicalGirl ! ! !\"</span></span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>          style<span class=\"token punctuation\">:</span> <span class=\"token class-name\">TextStyle</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            inherit<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>            color<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Colors</span><span class=\"token punctuation\">.</span>blue<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>          <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        backgroundColor<span class=\"token punctuation\">:</span> <span class=\"token keyword\">const</span> <span class=\"token class-name\">Color</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xFFFFB6C1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// ç²‰è‰²èƒŒæ™¯</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>      body<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Container</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        padding<span class=\"token punctuation\">:</span> <span class=\"token keyword\">const</span> <span class=\"token class-name\">EdgeInsets</span><span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token number\">16.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        child<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Center</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>          child<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Column</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>            mainAxisAlignment<span class=\"token punctuation\">:</span> <span class=\"token class-name\">MainAxisAlignment</span><span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>            mainAxisSize<span class=\"token punctuation\">:</span> <span class=\"token class-name\">MainAxisSize</span><span class=\"token punctuation\">.</span>max<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>            crossAxisAlignment<span class=\"token punctuation\">:</span> <span class=\"token class-name\">CrossAxisAlignment</span><span class=\"token punctuation\">.</span>center<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>            children<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>              <span class=\"token comment\">// æ–‡æœ¬è¾“å…¥æ¡†</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>              <span class=\"token class-name\">TextField</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>                controller<span class=\"token punctuation\">:</span> _textController<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>                decoration<span class=\"token punctuation\">:</span> <span class=\"token keyword\">const</span> <span class=\"token class-name\">InputDecoration</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>                  hintText<span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"Fill Magical Spell Here and Press enter...\"</span></span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>                  filled<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>                <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>                textCapitalization<span class=\"token punctuation\">:</span> <span class=\"token class-name\">TextCapitalization</span><span class=\"token punctuation\">.</span>none<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>                textAlign<span class=\"token punctuation\">:</span> <span class=\"token class-name\">TextAlign</span><span class=\"token punctuation\">.</span>left<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>                obscureText<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>                autocorrect<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>                obscuringCharacter<span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"â€¢\"</span></span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>                enableSuggestions<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>                autofocus<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>                enableInteractiveSelection<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>                maxLines<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>                readOnly<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>                onSubmitted<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> value<span class=\"token punctuation\">)</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>                  <span class=\"token keyword\">await</span> <span class=\"token function\">_onTextSubmitted</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>                cursorHeight<span class=\"token punctuation\">:</span> <span class=\"token number\">2.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>                scrollPadding<span class=\"token punctuation\">:</span> <span class=\"token keyword\">const</span> <span class=\"token class-name\">EdgeInsets</span><span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token number\">20.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>                keyboardType<span class=\"token punctuation\">:</span> <span class=\"token class-name\">TextInputType</span><span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>                enableIMEPersonalizedLearning<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>              <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>              </pre></td></tr><tr><td data-num=\"85\"></td><td><pre>              <span class=\"token comment\">// æ˜¾ç¤ºå½“å‰æ–‡æœ¬</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>              <span class=\"token class-name\">Text</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>                _displayText<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>                style<span class=\"token punctuation\">:</span> <span class=\"token keyword\">const</span> <span class=\"token class-name\">TextStyle</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>                  inherit<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>                  color<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Colors</span><span class=\"token punctuation\">.</span>blue<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>                <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>              <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>              </pre></td></tr><tr><td data-num=\"94\"></td><td><pre>              <span class=\"token comment\">// æ‰©å±•çš„æ˜¾ç¤ºæ–‡æœ¬åŒºåŸŸ</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>              <span class=\"token class-name\">Expanded</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>                flex<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>                child<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Text</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>                  _displayText<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>                  style<span class=\"token punctuation\">:</span> <span class=\"token keyword\">const</span> <span class=\"token class-name\">TextStyle</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>                    inherit<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>                    fontSize<span class=\"token punctuation\">:</span> <span class=\"token number\">16.0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>                    fontWeight<span class=\"token punctuation\">:</span> <span class=\"token class-name\">FontWeight</span><span class=\"token punctuation\">.</span>bold<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>                  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>                <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>              <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>            <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>          <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>      resizeToAvoidBottomInset<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>      extendBody<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>      extendBodyBehindAppBar<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>  <span class=\"token comment\">// æ–‡æœ¬æäº¤å¤„ç†</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>  <span class=\"token class-name\">Future</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">_onTextSubmitted</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> value<span class=\"token punctuation\">)</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>    <span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>      <span class=\"token function\">check</span><span class=\"token punctuation\">(</span>_textController<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>      _textController<span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> <span class=\"token string-literal\"><span class=\"token string\">\"\"</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>  <span class=\"token comment\">// æ ¸å¿ƒéªŒè¯æ–¹æ³• - è¿™æ˜¯å…³é”®é€»è¾‘</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>  <span class=\"token keyword\">void</span> <span class=\"token function\">check</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TextEditingController</span> controller<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> inputText<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>    <span class=\"token comment\">// 1. åˆå§‹åŒ– AES åŠ å¯†</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>    <span class=\"token keyword\">final</span> aesCrypt <span class=\"token operator\">=</span> <span class=\"token class-name\">AesCrypt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"129\"></td><td><pre>    <span class=\"token comment\">// 2. åˆ›å»ºä¸¤ä¸ªä¸åŒçš„åˆå§‹å‘é‡æ•°ç»„</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>int<span class=\"token punctuation\">></span></span> iv1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">126</span><span class=\"token punctuation\">,</span> <span class=\"token number\">70</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">426</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 0x7E, 0x46, 0x06, 0x1AA</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>int<span class=\"token punctuation\">></span></span> iv2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>     <span class=\"token comment\">// 0x02, 0x02, 0x08, 0x0A</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"133\"></td><td><pre>    <span class=\"token comment\">// 3. è½¬æ¢ä¸º Uint8List</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>    <span class=\"token class-name\">Uint8List</span> ivBytes1 <span class=\"token operator\">=</span> <span class=\"token class-name\">Uint8List</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>    ivBytes1<span class=\"token punctuation\">.</span><span class=\"token function\">setRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> iv1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"137\"></td><td><pre>    <span class=\"token class-name\">Uint8List</span> ivBytes2 <span class=\"token operator\">=</span> <span class=\"token class-name\">Uint8List</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre>    ivBytes2<span class=\"token punctuation\">.</span><span class=\"token function\">setRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> iv2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"140\"></td><td><pre>    <span class=\"token comment\">// 4. è·å–å¯¹ç§°å¯†é’¥</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>    _symmetricKey <span class=\"token operator\">=</span> <span class=\"token function\">getSym</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"143\"></td><td><pre>    <span class=\"token comment\">// 5. å…³é”®åˆ¤æ–­ï¼šæ£€æŸ¥å¯¹ç§°å¯†é’¥çš„ç¬¬ 7 ä¸ªå­—èŠ‚æ˜¯å¦ä¸º 0xD6</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>    <span class=\"token keyword\">final</span> symBuffer <span class=\"token operator\">=</span> _symmetricKey<span class=\"token punctuation\">.</span><span class=\"token function\">asUint8List</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>    bool isSpecialKey <span class=\"token operator\">=</span> symBuffer<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">0xD6</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"147\"></td><td><pre>    <span class=\"token comment\">// 6. æ ¹æ®å¯†é’¥ç±»å‹é€‰æ‹©ä¸åŒçš„å¤„ç†è·¯å¾„</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>    <span class=\"token class-name\">Uint8List</span> finalKeyBytes<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isSpecialKey<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>      <span class=\"token comment\">// ç‰¹æ®Šå¯†é’¥è·¯å¾„ï¼šä½¿ç”¨ ivBytes2</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>      <span class=\"token keyword\">final</span> keyData <span class=\"token operator\">=</span> <span class=\"token function\">getKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre>      <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>int<span class=\"token punctuation\">></span></span> keyList <span class=\"token operator\">=</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>int<span class=\"token punctuation\">></span></span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>keyData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre>      keyList<span class=\"token punctuation\">.</span><span class=\"token function\">addAll</span><span class=\"token punctuation\">(</span>ivBytes2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre>      finalKeyBytes <span class=\"token operator\">=</span> <span class=\"token class-name\">Uint8List</span><span class=\"token punctuation\">.</span><span class=\"token function\">fromList</span><span class=\"token punctuation\">(</span>keyList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>      <span class=\"token comment\">// æ™®é€šå¯†é’¥è·¯å¾„ï¼šä½¿ç”¨ ivBytes1</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>      <span class=\"token keyword\">final</span> keyData <span class=\"token operator\">=</span> <span class=\"token function\">getKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre>      <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>int<span class=\"token punctuation\">></span></span> keyList <span class=\"token operator\">=</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>int<span class=\"token punctuation\">></span></span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>keyData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre>      keyList<span class=\"token punctuation\">.</span><span class=\"token function\">addAll</span><span class=\"token punctuation\">(</span>ivBytes1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre>      finalKeyBytes <span class=\"token operator\">=</span> <span class=\"token class-name\">Uint8List</span><span class=\"token punctuation\">.</span><span class=\"token function\">fromList</span><span class=\"token punctuation\">(</span>keyList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"163\"></td><td><pre>    <span class=\"token comment\">// 7. å‡†å¤‡ AES å¯†é’¥ (32 å­—èŠ‚ï¼Œ256 ä½)</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre>    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>int<span class=\"token punctuation\">></span></span> aesKeySequence <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre>      <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"166\"></td><td><pre>      <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">28</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre>    <span class=\"token class-name\">Uint8List</span> aesKeyBytes <span class=\"token operator\">=</span> <span class=\"token class-name\">Uint8List</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre>    aesKeyBytes<span class=\"token punctuation\">.</span><span class=\"token function\">setRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> aesKeySequence<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"171\"></td><td><pre>    <span class=\"token comment\">// 8. è®¾ç½® AES åŠ å¯†å‚æ•°</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre>    aesCrypt<span class=\"token punctuation\">.</span><span class=\"token function\">aesSetKeys</span><span class=\"token punctuation\">(</span>finalKeyBytes<span class=\"token punctuation\">,</span> aesKeyBytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre>    aesCrypt<span class=\"token punctuation\">.</span><span class=\"token function\">aesSetMode</span><span class=\"token punctuation\">(</span><span class=\"token comment\">/* è®¾ç½®åŠ å¯†æ¨¡å¼ */</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"175\"></td><td><pre>    <span class=\"token comment\">// 9. å¯¹è¾“å…¥æ–‡æœ¬è¿›è¡Œå¡«å……å¤„ç†</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre>    <span class=\"token class-name\">String</span> paddedText <span class=\"token operator\">=</span> <span class=\"token function\">padToBlockSize</span><span class=\"token punctuation\">(</span>controller<span class=\"token punctuation\">,</span> inputText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"178\"></td><td><pre>    <span class=\"token comment\">// 10. UTF-8 ç¼–ç </span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre>    <span class=\"token keyword\">final</span> utf8Bytes <span class=\"token operator\">=</span> <span class=\"token keyword\">const</span> <span class=\"token class-name\">Utf8Encoder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">convert</span><span class=\"token punctuation\">(</span>paddedText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"180\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"181\"></td><td><pre>    <span class=\"token comment\">// 11. AES åŠ å¯†</span></pre></td></tr><tr><td data-num=\"182\"></td><td><pre>    <span class=\"token keyword\">final</span> encryptedBytes <span class=\"token operator\">=</span> aesCrypt<span class=\"token punctuation\">.</span><span class=\"token function\">aesEncrypt</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Uint8List</span><span class=\"token punctuation\">.</span><span class=\"token function\">fromList</span><span class=\"token punctuation\">(</span>utf8Bytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"183\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"184\"></td><td><pre>    <span class=\"token comment\">// 12. å…³é”®æ£€æŸ¥ï¼šéªŒè¯å¯¹ç§°å¯†é’¥çš„ç‰¹å®šä½ç½®</span></pre></td></tr><tr><td data-num=\"185\"></td><td><pre>    <span class=\"token keyword\">final</span> symData <span class=\"token operator\">=</span> _symmetricKey<span class=\"token punctuation\">.</span><span class=\"token function\">asUint8List</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"186\"></td><td><pre>    int checkByte <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>symData<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token number\">0xD6</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// æ£€æŸ¥ç¬¬ 3 ä¸ªå­—èŠ‚çš„é«˜ä½</span></pre></td></tr><tr><td data-num=\"187\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"188\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>checkByte <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"189\"></td><td><pre>      <span class=\"token comment\">// å¦‚æœæ£€æŸ¥é€šè¿‡ï¼Œé€€å‡ºåº”ç”¨</span></pre></td></tr><tr><td data-num=\"190\"></td><td><pre>      <span class=\"token class-name\">SystemNavigator</span><span class=\"token punctuation\">.</span><span class=\"token function\">pop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"191\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"193\"></td><td><pre>    <span class=\"token comment\">// 13. è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²</span></pre></td></tr><tr><td data-num=\"194\"></td><td><pre>    <span class=\"token class-name\">String</span> hexResult <span class=\"token operator\">=</span> <span class=\"token function\">uint8ListToHex</span><span class=\"token punctuation\">(</span>controller<span class=\"token punctuation\">,</span> encryptedBytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"195\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"196\"></td><td><pre>    <span class=\"token comment\">// 14. å‘é€ç»“æœå¹¶å¤„ç†å“åº”</span></pre></td></tr><tr><td data-num=\"197\"></td><td><pre>    <span class=\"token function\">send</span><span class=\"token punctuation\">(</span>hexResult<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"198\"></td><td><pre>      <span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"199\"></td><td><pre>        <span class=\"token comment\">// æ£€æŸ¥å“åº”æ˜¯å¦ä¸ºç‰¹å®šçš„æˆåŠŸå­—ç¬¦ä¸²</span></pre></td></tr><tr><td data-num=\"200\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>response <span class=\"token operator\">==</span> <span class=\"token string-literal\"><span class=\"token string\">\"8sAFX45zT7uc0vSUyFNNly1h/d5zTt89tV3kcVr5P5n7lRKPyYtxg31zYNB2lPV0c5nf/x2/IK94XV9Ufs9XfaDG5IXxMlZy+Z2nE+ZZRFBSpMoKzQXfUq2TSjJJfQxV\"</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"201\"></td><td><pre>          _displayText <span class=\"token operator\">=</span> <span class=\"token string-literal\"><span class=\"token string\">\"You have become a magical girl ! !\"</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"202\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"203\"></td><td><pre>          _displayText <span class=\"token operator\">=</span> <span class=\"token string-literal\"><span class=\"token string\">\"This spell has no magic power\"</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"204\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"205\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"206\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"207\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"208\"></td><td><pre></pre></td></tr><tr><td data-num=\"209\"></td><td><pre>  <span class=\"token comment\">// å¡«å……æ–‡æœ¬åˆ°å—å¤§å°ï¼ˆPKCS7 å¡«å……ï¼‰</span></pre></td></tr><tr><td data-num=\"210\"></td><td><pre>  <span class=\"token class-name\">String</span> <span class=\"token function\">padToBlockSize</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TextEditingController</span> controller<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> text<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"211\"></td><td><pre>    <span class=\"token keyword\">const</span> int blockSize <span class=\"token operator\">=</span> <span class=\"token number\">16</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// AES å—å¤§å°</span></pre></td></tr><tr><td data-num=\"212\"></td><td><pre>    int textLength <span class=\"token operator\">=</span> text<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"213\"></td><td><pre>    int paddingLength <span class=\"token operator\">=</span> blockSize <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span>textLength <span class=\"token operator\">&amp;</span> <span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// textLength % 16</span></pre></td></tr><tr><td data-num=\"214\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"215\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>paddingLength <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"216\"></td><td><pre>      paddingLength <span class=\"token operator\">=</span> <span class=\"token number\">16</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// å¦‚æœå·²ç»æ˜¯ 16 çš„å€æ•°ï¼Œä»éœ€å¡«å…… 16 å­—èŠ‚</span></pre></td></tr><tr><td data-num=\"217\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"218\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"219\"></td><td><pre>    <span class=\"token comment\">// åˆ›å»ºå¡«å……å­—ç¬¦æ•°ç»„</span></pre></td></tr><tr><td data-num=\"220\"></td><td><pre>    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>int<span class=\"token punctuation\">></span></span> paddingChars <span class=\"token operator\">=</span> <span class=\"token class-name\">List</span><span class=\"token punctuation\">.</span><span class=\"token function\">filled</span><span class=\"token punctuation\">(</span>paddingLength<span class=\"token punctuation\">,</span> paddingLength <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"221\"></td><td><pre>    <span class=\"token class-name\">String</span> paddingString <span class=\"token operator\">=</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">fromCharCodes</span><span class=\"token punctuation\">(</span>paddingChars<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"222\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"223\"></td><td><pre>    <span class=\"token keyword\">return</span> text <span class=\"token operator\">+</span> paddingString<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"224\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"225\"></td><td><pre></pre></td></tr><tr><td data-num=\"226\"></td><td><pre>  <span class=\"token comment\">// å°† Uint8List è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²</span></pre></td></tr><tr><td data-num=\"227\"></td><td><pre>  <span class=\"token class-name\">String</span> <span class=\"token function\">uint8ListToHex</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TextEditingController</span> controller<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Uint8List</span> bytes<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"228\"></td><td><pre>    <span class=\"token keyword\">return</span> bytes<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>byte<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> byte<span class=\"token punctuation\">.</span><span class=\"token function\">toRadixString</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">padLeft</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string-literal\"><span class=\"token string\">'0'</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"229\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"230\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"231\"></td><td><pre></pre></td></tr><tr><td data-num=\"232\"></td><td><pre><span class=\"token comment\">// ä¸»åº”ç”¨å…¥å£</span></pre></td></tr><tr><td data-num=\"233\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">MagicalGirlEditApp</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">StatelessWidget</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"234\"></td><td><pre>  <span class=\"token keyword\">const</span> <span class=\"token class-name\">MagicalGirlEditApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token class-name\">Key</span><span class=\"token operator\">?</span> key<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">:</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"235\"></td><td><pre></pre></td></tr><tr><td data-num=\"236\"></td><td><pre>  <span class=\"token metadata function\">@override</span></pre></td></tr><tr><td data-num=\"237\"></td><td><pre>  <span class=\"token class-name\">Widget</span> <span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BuildContext</span> context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"238\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token class-name\">MaterialApp</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"239\"></td><td><pre>      title<span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">'Magical Girl Editor'</span></span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"240\"></td><td><pre>      theme<span class=\"token punctuation\">:</span> <span class=\"token class-name\">ThemeData</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"241\"></td><td><pre>        primarySwatch<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Colors</span><span class=\"token punctuation\">.</span>pink<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"242\"></td><td><pre>        visualDensity<span class=\"token punctuation\">:</span> <span class=\"token class-name\">VisualDensity</span><span class=\"token punctuation\">.</span>adaptivePlatformDensity<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"243\"></td><td><pre>      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"244\"></td><td><pre>      home<span class=\"token punctuation\">:</span> <span class=\"token keyword\">const</span> <span class=\"token class-name\">MyEditTextState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"245\"></td><td><pre>    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"246\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"247\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"248\"></td><td><pre></pre></td></tr><tr><td data-num=\"249\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"250\"></td><td><pre>  <span class=\"token function\">runApp</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token class-name\">MagicalGirlEditApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"251\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>çœ‹åˆ°ç»“æœçš„æ—¶å€™è¿è‡ªå·±éƒ½å“åˆ°äº†ï¼Œå’Œæºä»£ç å±…ç„¶ååˆ†æ¥è¿‘ï¼ˆå¦‚æœæ›´é«˜çº§çš„ <code>ai</code>  åº”è¯¥å°±èƒ½ <code>FullCombo</code>  äº†ï¼‰ï¼Œå¦‚æœåªåˆ†æå¤§æ¦‚é€»è¾‘ï¼Œè¿™ä¸ªè¾“å‡ºå·²ç»å®Œå…¨å¤Ÿç”¨äº†ã€‚</p>\n<p>åŸºäºæ­¤ç»“æœå¼€å§‹æˆ‘ä»¬çš„åˆ†æï¼Œ <code>check</code>  å‡½æ•°è°ƒç”¨äº†ä¸€ä¸ª AES åŠ å¯†ï¼Œ <code>aesSetKeys</code>  è°ƒç”¨æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œæˆ‘ä½¿ç”¨çš„ <code>ai</code>  è²Œä¼¼è¿™ä¸¤ä¸ªå‚æ•°éƒ½çŒœæˆ key äº† ( <code>finalKeyBytes, aesKeyBytes</code> ï¼Œæœ‰é’±çš„è€æ¿ç”¨ <code>GPT5</code>  è‚¯å®šä¸ä¼šå‡ºç°è¿™ç§æƒ…å†µå§)ï¼Œ <code>AES</code>  æœ‰çš„ä¸¤ä¸ªåŠ å¯†å‚æ•°ï¼Œå¯èƒ½æ˜¯ <code>KEY</code>  å’Œ <code>IV</code>  å¸¸è§ä¸º 16 å­—èŠ‚ï¼Œè¿™è¾¹åŠ å¯†æ¨¡å¼æ²¡åˆ†æå‡ºæ¥ï¼Œæˆ‘ä»¬å›åŸæ–‡çœ‹çœ‹ä¹Ÿæ²¡èƒ½çœ‹åˆ°å‚æ•°ï¼Œå¯ä»¥å…ˆæ”¾ä¸€ä¸‹ã€‚</p>\n<p><code>aesKeyBytes</code>  æ¥è‡ªé™æ€æ•°ç»„ <code>[2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32]</code>  åˆšå¥½ 16 ä½ï¼Œä½†æ˜¯éƒ½æ˜¯ 2 çš„å€æ•°ï¼Œ  <code>keyBytes</code>  æ¥è‡ªä¸¤ä¸ª <code>list</code>  æ‹¼æ¥ ( <code>addAll</code> )ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†åœ¨é€‰è‡ªé™æ€æ•°ç»„ <code>[2, 2, 8, 10]</code> , <code>[126, 70, 6, 426]</code>  å¦ä¸€éƒ¨åˆ†æ¥è‡ª <code>getKey</code> ï¼Œ å¯ä»¥å¯Ÿè§‰åˆ°ä¸å¯¹äº†ï¼ŒAES ä¼ å…¥çš„å¯†é’¥éƒ½æ˜¯ byte ç±»å‹ï¼Œä½†æ˜¯è¿™é‡Œæœ‰æ•°æ®è¶…è¿‡ 255ï¼Œå¹¶ä¸”ä¸å­˜åœ¨å¥‡æ•°ï¼Œé™¤ 2 ä¹‹å <code>[1,1,4,5]</code> ï¼Œç¬é—´å¯ä»¥è¦ç´ å¯Ÿè§‰äº†ï¼Œè¿™é‡Œçš„æ‰€æœ‰ byte éƒ½æ˜¯å·¦ç§» 1 ä½çš„ã€‚åŒæ—¶ <code>finalKeyBytes</code>  çš„æœ€ç»ˆå€¼å–å†³äº <code>getSym</code>  è¿”å›çš„ç¬¬å…«ä½æ˜¯å¦ç­‰äº <code>0xD6</code> ã€‚</p>\n<p>å†æ¥åˆ†æåŠ å¯†ä»£ç ï¼ŒæŸ¥çœ‹ <code>aes_crypt_null_safe.dart</code>  çš„ <code>_sBox</code>  å‡½æ•° (ä¸ºä»€ä¹ˆè¦çœ‹è¿™ä¸ªï¼Ÿå› ä¸ºè¿™å±äºå¸¸è§é­”æ”¹é¡¹å§ï¼Œéƒ½ä½äº <code>magical_girl</code>  ç›®å½•ä¸‹äº†ï¼Œè‚¯å®šä¸ä¼šæ˜¯æ ‡å‡†åŠ å¯†äº†)ã€‚</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">0x2903a0</span><span class=\"token operator\">:</span> mov             x17<span class=\"token punctuation\">,</span> #<span class=\"token number\">0xf6</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>     <span class=\"token number\">0x2903a4</span><span class=\"token operator\">:</span> StoreField<span class=\"token operator\">:</span> r0<span class=\"token operator\">-></span>field_13 <span class=\"token operator\">=</span> r17</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>         <span class=\"token number\">0x2903a4</span><span class=\"token operator\">:</span> stur            w17<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>x0<span class=\"token punctuation\">,</span> #<span class=\"token number\">0x13</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>     <span class=\"token number\">0x2903a8</span><span class=\"token operator\">:</span> r17 <span class=\"token operator\">=</span> <span class=\"token number\">48</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>         <span class=\"token number\">0x2903a8</span><span class=\"token operator\">:</span> mov             x17<span class=\"token punctuation\">,</span> #<span class=\"token number\">0x30</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>     <span class=\"token number\">0x2903ac</span><span class=\"token operator\">:</span> ArrayStore<span class=\"token operator\">:</span> r0<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> r17  <span class=\"token punctuation\">;</span> List_4</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>         <span class=\"token number\">0x2903ac</span><span class=\"token operator\">:</span> stur            w17<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>x0<span class=\"token punctuation\">,</span> #<span class=\"token number\">0x17</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>     <span class=\"token number\">0x2903b0</span><span class=\"token operator\">:</span> r17 <span class=\"token operator\">=</span> <span class=\"token number\">334</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>         <span class=\"token number\">0x2903b0</span><span class=\"token operator\">:</span> mov             x17<span class=\"token punctuation\">,</span> #<span class=\"token number\">0x14e</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>     <span class=\"token number\">0x2903b4</span><span class=\"token operator\">:</span> StoreField<span class=\"token operator\">:</span> r0<span class=\"token operator\">-></span>field_1b <span class=\"token operator\">=</span> r17</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>         <span class=\"token number\">0x2903b4</span><span class=\"token operator\">:</span> stur            w17<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>x0<span class=\"token punctuation\">,</span> #<span class=\"token number\">0x1b</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>     <span class=\"token number\">0x2903b8</span><span class=\"token operator\">:</span> r17 <span class=\"token operator\">=</span> <span class=\"token number\">132</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>         <span class=\"token number\">0x2903b8</span><span class=\"token operator\">:</span> mov             x17<span class=\"token punctuation\">,</span> #<span class=\"token number\">0x84</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>     <span class=\"token number\">0x2903bc</span><span class=\"token operator\">:</span> StoreField<span class=\"token operator\">:</span> r0<span class=\"token operator\">-></span>field_1f <span class=\"token operator\">=</span> r17</pre></td></tr></table></figure><p>æœ‰å¾ˆå¤šå­˜å‚¨å¸¸é‡æ“ä½œï¼Œç®—ä¸€ä¸‹åˆšå¥½ 256 ä¸ªï¼Œè¿™å°±æ˜¯ SBOXï¼Œè¿™é‡Œçš„æ•°æ®ä¹Ÿæ˜¯å·¦ç§»ä¸€ä½çš„ï¼Œæ‰£å‡ºæ¥å°±å¯ä»¥å†™é€†ç›’äº†ã€‚<br />\n <code>aes_crypt_null_safe.dart</code>  åŒæ ·å¯ä»¥ <code>ai</code>  è¿˜åŸï¼Œä½†æ˜¯è¿™éƒ¨åˆ†å‡ºç° <code>ai</code>  å¹»è§‰å¤ªä¸¥é‡äº†ï¼Œç½‘ä¸Šæœ‰å¼€æºç®—æ³•å¼•å¯¼ <code>ai</code>  è¾“å‡ºæ ‡å‡†ç»“æœã€‚ç”¨é™æ€åˆ†æè¿˜å¯ä»¥åˆ†æå‡ºç¬¬äºŒå¤„é­”æ”¹ã€‚</p>\n<figure class=\"highlight dart\"><figcaption data-lang=\"dart\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">0x28d728</span><span class=\"token punctuation\">:</span> cmp             x1<span class=\"token punctuation\">,</span> x3</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>     <span class=\"token number\">0x28d72c</span><span class=\"token punctuation\">:</span> b<span class=\"token punctuation\">.</span>ge            #<span class=\"token number\">0x28d770</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>     <span class=\"token number\">0x28d730</span><span class=\"token punctuation\">:</span> str             x0<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>     <span class=\"token number\">0x28d734</span><span class=\"token punctuation\">:</span> r0 <span class=\"token operator\">=</span> <span class=\"token function\">_subBytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>         <span class=\"token number\">0x28d734</span><span class=\"token punctuation\">:</span> bl              #<span class=\"token number\">0x2901b8</span>  <span class=\"token punctuation\">;</span> <span class=\"token punctuation\">[</span>package<span class=\"token punctuation\">:</span>magical_girl<span class=\"token operator\">/</span>aes_crypt_null_safe<span class=\"token punctuation\">.</span>dart<span class=\"token punctuation\">]</span> _Aes<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>_subBytes</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>     <span class=\"token number\">0x28d738</span><span class=\"token punctuation\">:</span> ldr             x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>fp<span class=\"token punctuation\">,</span> #<span class=\"token number\">0x18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>     <span class=\"token number\">0x28d73c</span><span class=\"token punctuation\">:</span> str             x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>     <span class=\"token number\">0x28d740</span><span class=\"token punctuation\">:</span> r0 <span class=\"token operator\">=</span> <span class=\"token function\">_shiftRows</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>         <span class=\"token number\">0x28d740</span><span class=\"token punctuation\">:</span> bl              #<span class=\"token number\">0x28ffb4</span>  <span class=\"token punctuation\">;</span> <span class=\"token punctuation\">[</span>package<span class=\"token punctuation\">:</span>magical_girl<span class=\"token operator\">/</span>aes_crypt_null_safe<span class=\"token punctuation\">.</span>dart<span class=\"token punctuation\">]</span> _Aes<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>_shiftRows</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>     <span class=\"token number\">0x28d744</span><span class=\"token punctuation\">:</span> ldr             x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>fp<span class=\"token punctuation\">,</span> #<span class=\"token number\">0x18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>     <span class=\"token number\">0x28d748</span><span class=\"token punctuation\">:</span> str             x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">,</span> #<span class=\"token number\">8</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>     <span class=\"token number\">0x28d74c</span><span class=\"token punctuation\">:</span> ldur            x0<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>fp<span class=\"token punctuation\">,</span> #<span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>     <span class=\"token number\">0x28d750</span><span class=\"token punctuation\">:</span> str             x0<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>     <span class=\"token number\">0x28d754</span><span class=\"token punctuation\">:</span> r0 <span class=\"token operator\">=</span> <span class=\"token function\">_addRoundKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>         <span class=\"token number\">0x28d754</span><span class=\"token punctuation\">:</span> bl              #<span class=\"token number\">0x291204</span>  <span class=\"token punctuation\">;</span> <span class=\"token punctuation\">[</span>package<span class=\"token punctuation\">:</span>magical_girl<span class=\"token operator\">/</span>aes_crypt_null_safe<span class=\"token punctuation\">.</span>dart<span class=\"token punctuation\">]</span> _Aes<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>_addRoundKey</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>     <span class=\"token number\">0x28d758</span><span class=\"token punctuation\">:</span> ldr             x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>fp<span class=\"token punctuation\">,</span> #<span class=\"token number\">0x18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>     <span class=\"token number\">0x28d75c</span><span class=\"token punctuation\">:</span> str             x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>     <span class=\"token number\">0x28d760</span><span class=\"token punctuation\">:</span> r0 <span class=\"token operator\">=</span> <span class=\"token function\">_mixColumns</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>         <span class=\"token number\">0x28d760</span><span class=\"token punctuation\">:</span> bl              #<span class=\"token number\">0x28d8b0</span>  <span class=\"token punctuation\">;</span> <span class=\"token punctuation\">[</span>package<span class=\"token punctuation\">:</span>magical_girl<span class=\"token operator\">/</span>aes_crypt_null_safe<span class=\"token punctuation\">.</span>dart<span class=\"token punctuation\">]</span> _Aes<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>_mixColumns</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>     <span class=\"token number\">0x28d764</span><span class=\"token punctuation\">:</span> ldur            x0<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>fp<span class=\"token punctuation\">,</span> #<span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>     <span class=\"token number\">0x28d768</span><span class=\"token punctuation\">:</span> add             x1<span class=\"token punctuation\">,</span> x0<span class=\"token punctuation\">,</span> #<span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>     <span class=\"token number\">0x28d76c</span><span class=\"token punctuation\">:</span> b               #<span class=\"token number\">0x28d6f8</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>     <span class=\"token number\">0x28d770</span><span class=\"token punctuation\">:</span> mov             x0<span class=\"token punctuation\">,</span> x1</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>     <span class=\"token number\">0x28d774</span><span class=\"token punctuation\">:</span> ldur            x1<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>fp<span class=\"token punctuation\">,</span> #<span class=\"token operator\">-</span><span class=\"token number\">0x20</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>     <span class=\"token number\">0x28d778</span><span class=\"token punctuation\">:</span> ldr             x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>fp<span class=\"token punctuation\">,</span> #<span class=\"token number\">0x18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>     <span class=\"token number\">0x28d77c</span><span class=\"token punctuation\">:</span> str             x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span></pre></td></tr></table></figure><p>è½®å¯†é’¥åŠ å¯†å’Œåˆ—æ··æ·†äº¤æ¢ä½ç½®ï¼Œå¾ˆå¸¸è§çš„é­”æ”¹ã€‚æ¥ä¸‹æ¥é€šè¿‡è°ƒè¯•æ¶ˆå»ä¸ç¡®å®šå› ç´ ã€‚</p>\n<p>ä¸çŸ¥é“å¤§å®¶æ˜¯å¦æœ‰å‘ç° <code>IDA</code>  åˆ†æçš„æ±‡ç¼–ç»“æœå’Œ <code>blutter</code>  è§£æç»“æœæœ‰å‡ºå…¥</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>blutter<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token number\">0x28c25c</span><span class=\"token operator\">:</span> ldur            x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>fp<span class=\"token punctuation\">,</span> #<span class=\"token operator\">-</span><span class=\"token number\">0x10</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token number\">0x28c260</span><span class=\"token operator\">:</span> str             x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token number\">0x28c264</span><span class=\"token operator\">:</span> r0 <span class=\"token operator\">=</span> <span class=\"token function\">aesSetMode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>IDA<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token number\">0x28C25C</span>                  LDUR            X16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>X29<span class=\"token punctuation\">,</span>#<span class=\"token operator\">-</span><span class=\"token number\">0x10</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token number\">0x28C260</span>                  STR             X16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>X15<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token number\">0x28C264</span>                  BL              magical_girl$aes_crypt_null_safe_AesCrypt__aesSetMode_291548</pre></td></tr></table></figure><p>å¯¹äº <code>x29</code>  å¯„å­˜å™¨ï¼Œç†Ÿæ‚‰ <code>arm</code>  çš„æœ‹å‹éƒ½çŸ¥é“ï¼ŒæŒ‡çš„å°±æ˜¯ <code>fp</code>  å¯„å­˜å™¨ã€‚ä½†æ˜¯å¯¹äº <code>x15</code>  å¯„å­˜å™¨æ¥è¯´ï¼Œè¿™ä¸ªå¯„å­˜å™¨å’Œ <code>sp</code>  å¹¶æ²¡æœ‰ä»€ä¹ˆå…³ç³»ï¼ˆ <code>arm</code>  çš„ <code>sp</code>  æ˜¯ <code>x31</code>  å¯„å­˜å™¨ï¼‰ã€‚è¯´æ˜ <code>flutter</code>  å‡½æ•°çš„è°ƒç”¨å¹¶éæ ‡å‡†è°ƒç”¨ï¼Œäº‹å®ä¸Šä» <code>blutter</code>  ç”Ÿæˆçš„ <code>blutter_frida.js</code>  ä¾¿å¯ä»¥çœ‹å‡ºç«¯å€ªï¼Œ</p>\n<figure class=\"highlight js\"><figcaption data-lang=\"JavaScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> PointerCompressedEnabled <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">const</span> CompressedWordSize <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">const</span> HeapAddressReg <span class=\"token operator\">=</span> <span class=\"token string\">'x28'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">const</span> NullReg <span class=\"token operator\">=</span> <span class=\"token string\">'x22'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">const</span> StackReg <span class=\"token operator\">=</span> <span class=\"token string\">'x15'</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>æ ˆæŒ‡é’ˆè¢«å®šä¹‰ä¸º x15ï¼Œè¿™ä¸ª x15 å‡ ä¹ä¸ä¼šè¢«ç¨‹åºä¿®æ”¹ï¼Œï¼Œè¿™é‡Œç”¨ä½œæ ˆæŒ‡é’ˆä¹Ÿå°šå¯ã€‚<br />\nåŒæ—¶ <code>blutter_frida.js</code>  è¿˜å­˜åœ¨ä»¥ä¸‹ä»£ç ï¼Œè¯´æ˜ï¼Œä¼ å‚æ˜¯é€šè¿‡æ ˆè¿›è¡Œçš„ã€‚</p>\n<figure class=\"highlight js\"><figcaption data-lang=\"JavaScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">getArg</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">context<span class=\"token punctuation\">,</span> idx</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token comment\">// Note: argument pointer is never compressed</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">let</span> stack <span class=\"token operator\">=</span> context<span class=\"token punctuation\">[</span>StackReg<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">return</span> stack<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span> <span class=\"token operator\">*</span> idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">readPointer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><code>IDA</code>  æŠŠå‡½æ•°åˆ†æä¸º <code>fastcall</code>  è°ƒç”¨çº¦å®šï¼Œå¹¶ä¸é€‚ç”¨äº <code>Flutter</code>  å‡½æ•°ï¼Œæ‰€ä»¥åç¼–è¯‘ç»“æœååˆ†ä¸‘é™‹ã€‚æˆ‘ä»¬è¿™é‡Œå¯ä»¥æ¥å€Ÿç”¨ <code>blutter_frida.js</code>  åˆ†æä¸€ä¸‹ä¼ å‚è§„åˆ™ã€‚</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">0x28c244</span><span class=\"token operator\">:</span> ldur            x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>fp<span class=\"token punctuation\">,</span> #<span class=\"token operator\">-</span><span class=\"token number\">0x10</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token number\">0x28c248</span><span class=\"token operator\">:</span> ldur            lr<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>fp<span class=\"token punctuation\">,</span> #<span class=\"token operator\">-</span><span class=\"token number\">0x18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token number\">0x28c24c</span><span class=\"token operator\">:</span> stp             lr<span class=\"token punctuation\">,</span> x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">,</span> #<span class=\"token number\">8</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token number\">0x28c250</span><span class=\"token operator\">:</span> ldur            x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>fp<span class=\"token punctuation\">,</span> #<span class=\"token operator\">-</span><span class=\"token number\">0x20</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token number\">0x28c254</span><span class=\"token operator\">:</span> str             x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token number\">0x28c258</span><span class=\"token operator\">:</span> r0 <span class=\"token operator\">=</span> <span class=\"token function\">aesSetKeys</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token number\">0x28c258</span><span class=\"token operator\">:</span> bl              #<span class=\"token number\">0x2915a4</span>  <span class=\"token punctuation\">;</span> <span class=\"token punctuation\">[</span>package<span class=\"token operator\">:</span>magical_girl<span class=\"token operator\">/</span>aes_crypt_null_safe<span class=\"token punctuation\">.</span>dart<span class=\"token punctuation\">]</span> AesCrypt<span class=\"token operator\">::</span>aesSetKeys</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token number\">0x28c25c</span><span class=\"token operator\">:</span> ldur            x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>fp<span class=\"token punctuation\">,</span> #<span class=\"token operator\">-</span><span class=\"token number\">0x10</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token number\">0x28c260</span><span class=\"token operator\">:</span> str             x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token number\">0x28c264</span><span class=\"token operator\">:</span> r0 <span class=\"token operator\">=</span> <span class=\"token function\">aesSetMode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token number\">0x28c264</span><span class=\"token operator\">:</span> bl              #<span class=\"token number\">0x291548</span>  <span class=\"token punctuation\">;</span> <span class=\"token punctuation\">[</span>package<span class=\"token operator\">:</span>magical_girl<span class=\"token operator\">/</span>aes_crypt_null_safe<span class=\"token punctuation\">.</span>dart<span class=\"token punctuation\">]</span> AesCrypt<span class=\"token operator\">::</span>aesSetMode</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token number\">0x28c268</span><span class=\"token operator\">:</span> ldr             x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>fp<span class=\"token punctuation\">,</span> #<span class=\"token number\">0x18</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token number\">0x28c26c</span><span class=\"token operator\">:</span> ldr             lr<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>fp<span class=\"token punctuation\">,</span> #<span class=\"token number\">0x10</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token number\">0x28c270</span><span class=\"token operator\">:</span> stp             lr<span class=\"token punctuation\">,</span> x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token number\">0x28c288</span><span class=\"token operator\">:</span> ldur            x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>fp<span class=\"token punctuation\">,</span> #<span class=\"token operator\">-</span><span class=\"token number\">0x10</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token number\">0x28c28c</span><span class=\"token operator\">:</span> stp             x0<span class=\"token punctuation\">,</span> x16<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>SP<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token number\">0x28c290</span><span class=\"token operator\">:</span> r0 <span class=\"token operator\">=</span> <span class=\"token function\">aesEncrypt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>é¦–å…ˆï¼Œ <code>aesSetKeys()</code>  ä¼ å…¥äº†ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ <code>key</code> , ä¸€ä¸ªæ˜¯ <code>iv</code> , æˆ‘ä»¬é€šè¿‡ä»¥ä¸‹ä¿®æ”¹æ¥ <code>hook</code>  è°ƒç”¨å‚æ•°</p>\n<figure class=\"highlight js\"><figcaption data-lang=\"JavaScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// ä½¿å¼¹çª—å¯å…³é—­</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Java<span class=\"token punctuation\">.</span><span class=\"token function\">perform</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">let</span> a <span class=\"token operator\">=</span> Java<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"android.widget.Button\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    a<span class=\"token punctuation\">[</span><span class=\"token string\">\"setEnabled\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">implementation</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">enable</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Button set enable\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"setEnabled\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">const</span> ShowNullField <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">const</span> MaxDepth <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">var</span> libapp <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">onLibappLoaded</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token comment\">// xxx(\"remove this line and correct the hook value\");</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">const</span> fn_addr <span class=\"token operator\">=</span> <span class=\"token number\">0x2915a4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    Interceptor<span class=\"token punctuation\">.</span><span class=\"token function\">attach</span><span class=\"token punctuation\">(</span>libapp<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>fn_addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function-variable function\">onEnter</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token keyword\">let</span> objPtr <span class=\"token operator\">=</span> <span class=\"token function\">getArg</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>tptr<span class=\"token punctuation\">,</span> cls<span class=\"token punctuation\">,</span> values<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">getTaggedObjectValue</span><span class=\"token punctuation\">(</span>objPtr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>cls<span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">@</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>tptr<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\"> =</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>values<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><code>getArg(this.context, 0)</code>  æ›´æ”¹ç¬¬äºŒä¸ªå‚æ•°æ§åˆ¶ä¼ å‚æ‰“å°ä½ç½®</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>frida -U -f work.pangbai.magic.magical_girl -l blutter_frida.js</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>     ____</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    / _  |   Frida <span class=\"token number\">16.6</span>.<span class=\"token number\">6</span> - A world-class dynamic instrumentation toolkit</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   | (_| |</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    > _  |   Commands<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   /_/ |_|       help      -> Displays the help system</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   . . . .       object?   -> Display information about 'object'</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   . . . .       exit/quit -> Exit</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   . . . .</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   . . . .   More info at https<span class=\"token operator\">:</span><span class=\"token comment\">//frida.re/docs/home/</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   . . . .</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>   . . . .   Connected to Android Emulator <span class=\"token number\">5554</span> (id=emulator<span class=\"token number\">-5554</span>)</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>Spawned `work.pangbai.magic.magical_girl`. Resuming main thread!        </pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">[</span>Android Emulator <span class=\"token number\">5554</span><span class=\"token operator\">:</span><span class=\"token operator\">:</span>work.pangbai.magic.magical_girl <span class=\"token punctuation\">]</span>-> Button set enable</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>_Uint8List@7b00721419 = <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token number\">1</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token number\">3</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token number\">4</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  <span class=\"token number\">5</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  <span class=\"token number\">6</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token number\">7</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  <span class=\"token number\">8</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  <span class=\"token number\">9</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>  <span class=\"token number\">10</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  <span class=\"token number\">11</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>  <span class=\"token number\">12</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  <span class=\"token number\">13</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>  <span class=\"token number\">14</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>  <span class=\"token number\">15</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>  <span class=\"token number\">16</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>Process terminated</pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">[</span>Android Emulator <span class=\"token number\">5554</span><span class=\"token operator\">:</span><span class=\"token operator\">:</span>work.pangbai.magic.magical_girl <span class=\"token punctuation\">]</span>-></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>Thank you for using Frida!</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>> frida -U -f work.pangbai.magic.magical_girl -l blutter_frida.js</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>     ____</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    / _  |   Frida <span class=\"token number\">16.6</span>.<span class=\"token number\">6</span> - A world-class dynamic instrumentation toolkit</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>   | (_| |</pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    > _  |   Commands<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>   /_/ |_|       help      -> Displays the help system</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>   . . . .       object?   -> Display information about 'object'</pre></td></tr><tr><td data-num=\"44\"></td><td><pre>   . . . .       exit/quit -> Exit</pre></td></tr><tr><td data-num=\"45\"></td><td><pre>   . . . .</pre></td></tr><tr><td data-num=\"46\"></td><td><pre>   . . . .   More info at https<span class=\"token operator\">:</span><span class=\"token comment\">//frida.re/docs/home/</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>   . . . .</pre></td></tr><tr><td data-num=\"48\"></td><td><pre>   . . . .   Connected to Android Emulator <span class=\"token number\">5554</span> (id=emulator<span class=\"token number\">-5554</span>)</pre></td></tr><tr><td data-num=\"49\"></td><td><pre>Spawned `work.pangbai.magic.magical_girl`. Resuming main thread!        </pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token punctuation\">[</span>Android Emulator <span class=\"token number\">5554</span><span class=\"token operator\">:</span><span class=\"token operator\">:</span>work.pangbai.magic.magical_girl <span class=\"token punctuation\">]</span>-> Button set enable</pre></td></tr><tr><td data-num=\"51\"></td><td><pre>_Uint8List@7b0071a079 = <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>  <span class=\"token number\">122</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>  <span class=\"token number\">37</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>  <span class=\"token number\">197</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>  <span class=\"token number\">36</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>  <span class=\"token number\">198</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>  <span class=\"token number\">51</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>  <span class=\"token number\">76</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>  <span class=\"token number\">48</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>  <span class=\"token number\">243</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>  <span class=\"token number\">98</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>  <span class=\"token number\">175</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>  <span class=\"token number\">172</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>  <span class=\"token number\">63</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>  <span class=\"token number\">35</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>  <span class=\"token number\">3</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>  <span class=\"token number\">213</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>Process terminated</pre></td></tr><tr><td data-num=\"70\"></td><td><pre><span class=\"token punctuation\">[</span>Android Emulator <span class=\"token number\">5554</span><span class=\"token operator\">:</span><span class=\"token operator\">:</span>work.pangbai.magic.magical_girl <span class=\"token punctuation\">]</span>-></pre></td></tr><tr><td data-num=\"71\"></td><td><pre></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>Thank you for using Frida!</pre></td></tr><tr><td data-num=\"73\"></td><td><pre>> frida -U -f work.pangbai.magic.magical_girl -l blutter_frida.js</pre></td></tr><tr><td data-num=\"74\"></td><td><pre>     ____</pre></td></tr><tr><td data-num=\"75\"></td><td><pre>    / _  |   Frida <span class=\"token number\">16.6</span>.<span class=\"token number\">6</span> - A world-class dynamic instrumentation toolkit</pre></td></tr><tr><td data-num=\"76\"></td><td><pre>   | (_| |</pre></td></tr><tr><td data-num=\"77\"></td><td><pre>    > _  |   Commands<span class=\"token operator\">:</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>   /_/ |_|       help      -> Displays the help system</pre></td></tr><tr><td data-num=\"79\"></td><td><pre>   . . . .       object?   -> Display information about 'object'</pre></td></tr><tr><td data-num=\"80\"></td><td><pre>   . . . .       exit/quit -> Exit</pre></td></tr><tr><td data-num=\"81\"></td><td><pre>   . . . .</pre></td></tr><tr><td data-num=\"82\"></td><td><pre>   . . . .   More info at https<span class=\"token operator\">:</span><span class=\"token comment\">//frida.re/docs/home/</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>   . . . .</pre></td></tr><tr><td data-num=\"84\"></td><td><pre>   . . . .   Connected to Android Emulator <span class=\"token number\">5554</span> (id=emulator<span class=\"token number\">-5554</span>)</pre></td></tr><tr><td data-num=\"85\"></td><td><pre>Spawned `work.pangbai.magic.magical_girl`. Resuming main thread!        </pre></td></tr><tr><td data-num=\"86\"></td><td><pre><span class=\"token punctuation\">[</span>Android Emulator <span class=\"token number\">5554</span><span class=\"token operator\">:</span><span class=\"token operator\">:</span>work.pangbai.magic.magical_girl <span class=\"token punctuation\">]</span>-> Button set enable</pre></td></tr><tr><td data-num=\"87\"></td><td><pre>Unhandle class id<span class=\"token operator\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> Sentinel</pre></td></tr><tr><td data-num=\"88\"></td><td><pre>Unhandle class id<span class=\"token operator\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> Sentinel</pre></td></tr><tr><td data-num=\"89\"></td><td><pre>Unhandle class id<span class=\"token operator\">:</span> <span class=\"token number\">85</span><span class=\"token punctuation\">,</span> Map</pre></td></tr><tr><td data-num=\"90\"></td><td><pre>AesCrypt@7b006f6bb9 = <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>  <span class=\"token property\">\"off_8!_Aes@7b006f6bc9\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>    <span class=\"token property\">\"off_8!Sentinel@7b00008301\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Unhandle class id: 30, Sentinel\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>    <span class=\"token property\">\"off_10!Sentinel@7b00008301\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Unhandle class id: 30, Sentinel\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>    <span class=\"token property\">\"off_14!List@7b006f6bf9\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>        <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>          <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>          <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>          <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>          <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>        <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>        <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>          <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>          <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>          <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>          <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>        <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>        <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>          <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>          <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>          <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>          <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>        <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>        <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>          <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>          <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>          <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>          <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>        <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>    <span class=\"token property\">\"off_18!AesMode@7b0045a1d1\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>      <span class=\"token property\">\"parent!_Enum\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>        <span class=\"token property\">\"off_8\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>        <span class=\"token property\">\"off_10!String@7b000f45e1\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"cbc\"</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>    <span class=\"token property\">\"off_1c!_Uint8List@7b006f6c99\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>    <span class=\"token property\">\"off_20!_Uint8List@7b006f6cb9\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>  <span class=\"token property\">\"off_c!Map@7b006f6da9\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Unhandle class id: 85, Map\"</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>Process terminated</pre></td></tr></table></figure><p>å¯¹ <code>aesSetMode</code>  å’Œ <code>aesEncrypt_28c6a8</code>  æ•…æŠ€é‡æ–½ï¼Œä¹Ÿå¯æ‰¾åˆ°è¾“å…¥çš„ <code>flag</code>  æ•°æ®ï¼ˆ <code>aesEncrypt_28c6a8</code>  éƒ½ç¬¬ä¸€ä¸ªå‚æ•°ï¼‰ï¼Œä¾¿å‘ç° <code>Flutter</code>  å‡½æ•°è°ƒç”¨çº¦å®š:<br />\n <code>å‚æ•°ä»å³å¾€å·¦å…¥æ ˆï¼Œæœ€åå…¥æ ˆå¯¹è±¡çš„thisæŒ‡é’ˆ</code> ã€‚åˆ°æ­¤å¤„ <code>Flutter</code>  é€†å‘ä¾¿å·²ç»å˜å¾—ååˆ†ç®€å•äº†ï¼Œ <code>IDA</code>  çš„é‚£äº›é”™è¯¯çš„å…¥å‚åˆ†æå˜å¾—æ¯«æ— ä»·å€¼ã€‚<br />\nå°†æ‰“å°å‚æ•°æ”¹ä¸ºå¯¹è±¡ <code>this</code>  æŒ‡é’ˆ ( <code>Hook</code>  ç‚¹å¿…é¡»åœ¨ <code>aesSetMode</code>  çš„åé¢ï¼Œä¸ç„¶æ‹¿åˆ°çš„è¾“å‡ºæ˜¯ <code>cbc</code> )ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>AES</code>  åŠ å¯†æ¨¡å¼ï¼š</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token property\">\"off_18!AesMode@7b0045a1d1\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>      <span class=\"token property\">\"parent!_Enum\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token property\">\"off_8\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token property\">\"off_10!String@7b000f45e1\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ecb\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr></table></figure><p><code>key</code>  åœ¨ <code>aesSetKeys</code>  ä¹Ÿç›´æ¥æ‰“å°å‡ºæ¥äº†ï¼Œæ¥ä¸‹æ¥åªè¦ <code>Hook</code>  è°ƒè¯•å„ä¸ªæ­¥éª¤çœ‹çœ‹åŠ å¯†çš„é­”æ”¹æƒ…å†µå°±è¡Œäº†ã€‚åŠ å¯†æ˜¯ <code>AES ecb</code>  åŠ å¯†ï¼Œ <code>IV</code>  å¤±å»äº†ä½œç”¨ã€‚<br />\nåˆ°æ­¤ <code>Flutter</code>  å±‚å°±åˆ†æå®Œæ¯•äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•å‘¢ï¼Œå“ˆå“ˆå“ˆã€‚</p>\n<h3 id=\"nativeæ„æ€\"><a class=\"anchor\" href=\"#nativeæ„æ€\">#</a> Native æ„æ€</h3>\n<p>æˆ‘è®¤ä¸ºç®€å•çš„ Flutter é€†å‘æ‹¿å‡ºæ¥ç»™å¸ˆå‚…ä»¬çœ‹ï¼Œè¿˜æ˜¯å¤ªè‰ç‡äº†ï¼Œå¤šå°‘æœ‰ç‚¹éš¾ç™»å¤§é›…ä¹‹å ‚ï¼ŒçœŸæ­£å¥½çš„é¢˜ç›®ï¼Œå‡ºé¢˜äººèŠ±è´¹çš„æ—¶é—´è¿œä¼šæ¯”åšé¢˜äººèŠ±è´¹çš„æ—¶é—´é•¿ã€‚</p>\n<p><code>Native</code>  é¦–å…ˆè¦ä»‹ç»ä¸€ä¸‹ <span class=\"exturl\" data-url=\"aHR0cHM6Ly9zb3VyY2UuYW5kcm9pZC5nb29nbGUuY24vZG9jcy9jb3JlL3Blcm1pc3Npb25zL25hbWVzcGFjZXNfbGlicmFyaWVzP2hsPXpoLWNu\">å®‰å“åŸç”Ÿåº“çš„å‘½åç©ºé—´</span><br />\n <code>Android 7.0</code>  ä¸ºåŸç”Ÿåº“å¼•å…¥äº†å‘½åç©ºé—´ï¼Œä»¥é™åˆ¶å†…éƒ¨ API çš„å¯è§æ€§ï¼Œå¬èµ·æ¥å¾ˆé«˜å¤§ä¸Šï¼Œå…·ä½“è§£é‡Šå°±æ˜¯å®‰å“ä¸Šçš„åŠ¨æ€é“¾æ¥åº“ä½¿ç”¨è¢«çº¦æŸäº†ï¼Œæ™®é€šå¼€å‘è€…ä¸ç®¡æ˜¯ç¼–è¯‘æ—¶é“¾æ¥è¿˜æ˜¯ä½¿ç”¨ <code>dlsym</code>  éƒ½ä¸èƒ½è·å–åˆ°è¢«é™åˆ¶çš„ lib çš„ç¬¦å·åœ°å€ï¼Œ <code>native</code>  å¼€å‘èƒ½è°ƒç”¨çš„ <code>api</code>  è¢«ä¸¥é‡é™åˆ¶ï¼ŒåŒç† <code>Java</code>  ä¹Ÿæœ‰ç±»ä¼¼çš„çº¦æŸ <code>hiddenapi</code>  ç”¨æ¥é™åˆ¶åå°„çš„åŠŸèƒ½ã€‚</p>\n<p>æœ¬é¢˜ç›®ä½¿ç”¨ <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3NzcmxpdmUvZmFrZS1kbGZjbg==\">fake-dlfcn</span> æ¥æŸ¥æ‰¾è°ƒç”¨  <code>libart.so</code>  çš„ç¬¦å·ï¼ŒåŒæ—¶ä¿®æ”¹äº†ä¸€äº›ä»£ç æ¥é€‚é…é«˜ç‰ˆæœ¬å®‰å“ã€‚è¿™ä¸ªé¡¹ç›®åŸç†æ¯”è¾ƒç®€å•ï¼Œæ‰«æ <code>proc/self/maps</code>  å¾—åˆ°åŸç”Ÿåº“çš„åŸºå€ï¼Œå¹¶é€šè¿‡è§£æåŸç”Ÿåº“çš„ <code>elf</code>  ç¬¦å·è¡¨å¾—åˆ°åç§»ï¼Œå†è¿›è¡Œè®¡ç®—å¾—åˆ°ç¬¦å·åœ°å€ã€‚</p>\n<p>é¢˜ç›®ä½¿ç”¨çš„ <code>inlineHook</code>  çš„ <code>shellcode</code>  æ¥è‡ª<a href=\"https://gitee.com/zzy_cs/inline-hook\"> inlineHook<br />\n</a></p>\n<p>æ¥ä¸‹æ¥å¯ä»¥çœ‹ <code>native</code>  äº†ï¼Œ <code>libnative_add.so</code>  åœ¨ <code>Flutter</code>  è¾“å…¥æ¡†å›è½¦çš„æ—¶å€™è¢«åŠ è½½ã€‚ <code>genKey</code>  å‡½æ•°æ˜¯ä¸€ä¸ª <code>rc4</code>  ç”¨æ¥ç”Ÿæˆé™æ€çš„ <code>Key</code> ï¼Œé€šè¿‡ <code>blutter</code>  ç”Ÿæˆçš„ä»£ç å¯ä»¥çŸ¥é“è¿™ä¸ªå‡½æ•°è¢« <code>flutter</code>  çš„ <code>getKey()</code>  è°ƒç”¨æ²¡æœ‰ä»€ä¹ˆéœ€è¦ç»†è¯´çš„ã€‚ <code>getSym</code>  å‡½æ•°è¢« <code>flutter</code>  çš„ <code>getSym</code>  å‡½æ•°è°ƒç”¨ã€‚å…¶ä¼ªä»£ç å¦‚ä¸‹</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>__int64 __fastcall <span class=\"token function\">getSym</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>a1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  __int64 result<span class=\"token punctuation\">;</span> <span class=\"token comment\">// x0</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  result <span class=\"token operator\">=</span> <span class=\"token function\">sub_19B50</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"libart.so\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0LL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> result <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token function\">sub_19F78</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">,</span> a1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>è°ƒç”¨ <code>fake-dlfcn</code>  è§£æè·å¾— <code>libart.so</code>  ä¸­æŒ‡å®šç¬¦å·çš„åœ°å€ï¼Œhook å³å¯å¾—åˆ°å‚æ•° a1 ä¸º <code>_ZN3art9ArtMethod12PrettyMethodEb</code> ï¼Œè¿™é‡Œå°±å¯ä»¥è§£ç­”ä¹‹å‰çš„è¿·æƒ‘äº†ï¼Œè¿™é‡Œçš„ getSym æ˜¯ <code>Frida</code>  æ£€æµ‹çš„ä¸€éƒ¨åˆ†ã€‚</p>\n<figure class=\"highlight dart\"><figcaption data-lang=\"dart\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>bool isSpecialKey <span class=\"token operator\">=</span> symBuffer<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">0xD6</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token comment\">// 6. æ ¹æ®å¯†é’¥ç±»å‹é€‰æ‹©ä¸åŒçš„å¤„ç†è·¯å¾„</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token class-name\">Uint8List</span> finalKeyBytes<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isSpecialKey<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token comment\">// ç‰¹æ®Šå¯†é’¥è·¯å¾„ï¼šä½¿ç”¨ ivBytes2</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token keyword\">final</span> keyData <span class=\"token operator\">=</span> <span class=\"token function\">getKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>int<span class=\"token punctuation\">></span></span> keyList <span class=\"token operator\">=</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>int<span class=\"token punctuation\">></span></span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>keyData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      keyList<span class=\"token punctuation\">.</span><span class=\"token function\">addAll</span><span class=\"token punctuation\">(</span>ivBytes2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      finalKeyBytes <span class=\"token operator\">=</span> <span class=\"token class-name\">Uint8List</span><span class=\"token punctuation\">.</span><span class=\"token function\">fromList</span><span class=\"token punctuation\">(</span>keyList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token comment\">// æ™®é€šå¯†é’¥è·¯å¾„ï¼šä½¿ç”¨ ivBytes1</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token keyword\">final</span> keyData <span class=\"token operator\">=</span> <span class=\"token function\">getKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>int<span class=\"token punctuation\">></span></span> keyList <span class=\"token operator\">=</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>int<span class=\"token punctuation\">></span></span><span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>keyData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      keyList<span class=\"token punctuation\">.</span><span class=\"token function\">addAll</span><span class=\"token punctuation\">(</span>ivBytes1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      finalKeyBytes <span class=\"token operator\">=</span> <span class=\"token class-name\">Uint8List</span><span class=\"token punctuation\">.</span><span class=\"token function\">fromList</span><span class=\"token punctuation\">(</span>keyList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    int checkByte <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>symData<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token number\">0xD6</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// æ£€æŸ¥ç¬¬ 3 ä¸ªå­—èŠ‚çš„é«˜ä½</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>checkByte <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token comment\">// å¦‚æœæ£€æŸ¥é€šè¿‡ï¼Œé€€å‡ºåº”ç”¨</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      <span class=\"token class-name\">SystemNavigator</span><span class=\"token punctuation\">.</span><span class=\"token function\">pop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æ£€æµ‹ <code>PrettyMethod</code>  çš„å‡½æ•°å¤´æ˜¯å¦æœ‰ <code>br</code>  æŒ‡ä»¤ç‰¹å¾ï¼ˆ0xD6ï¼‰ï¼Œ<br />\næ£€æµ‹ç‚¹æ¥è‡ªä»£ç  <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2ZyaWRhL2ZyaWRhLWphdmEtYnJpZGdlL2Jsb2IvOWJmODZiNzE4YWIzZTlkNTBkOTMzM2RiYTFmMjZlOGY3YWFkODUyYi9saWIvYW5kcm9pZC5qcyNMNDgwOQ==\">frida-java-bridge</span>ï¼Œ <code>libmsaoaidsec.so</code>  ä¹Ÿå­˜åœ¨è¿™ç§æ£€æµ‹æ–¹æ¡ˆã€‚</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>LOAD<span class=\"token operator\">:</span><span class=\"token number\">00000000001</span>A8BF4             <span class=\"token punctuation\">;</span> _QWORD art<span class=\"token operator\">::</span>ArtMethod<span class=\"token operator\">::</span><span class=\"token function\">PrettyMethod</span><span class=\"token punctuation\">(</span>art<span class=\"token operator\">::</span>ArtMethod <span class=\"token operator\">*</span>__hidden this<span class=\"token punctuation\">,</span> bool<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>LOAD<span class=\"token operator\">:</span><span class=\"token number\">00000000001</span>A8BF4                             EXPORT _ZN3art9ArtMethod12PrettyMethodEb</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>LOAD<span class=\"token operator\">:</span><span class=\"token number\">00000000001</span>A8BF4             _ZN3art9ArtMethod12PrettyMethodEb       <span class=\"token punctuation\">;</span> CODE XREF<span class=\"token operator\">:</span> sub_1549B8<span class=\"token operator\">+</span><span class=\"token number\">174</span>â†‘p</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>LOAD<span class=\"token operator\">:</span><span class=\"token number\">00000000001</span>A8BF4                                                     <span class=\"token punctuation\">;</span> sub_1698B8<span class=\"token operator\">+</span><span class=\"token number\">174</span>â†‘p <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>LOAD<span class=\"token operator\">:</span><span class=\"token number\">00000000001</span>A8BF4 <span class=\"token number\">50</span> <span class=\"token number\">00</span> <span class=\"token number\">00</span> <span class=\"token number\">58</span>                 LDR             X16<span class=\"token punctuation\">,</span> loc_1A8BFC</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>LOAD<span class=\"token operator\">:</span><span class=\"token number\">00000000001</span>A8BF8 <span class=\"token number\">00</span> <span class=\"token number\">02</span> <span class=\"token number\">1F</span> D6                 BR              X16</pre></td></tr></table></figure><p>è¿™ä¸ªæ£€æµ‹ç‚¹ä»ä»£ç ä¸Šæ¥çœ‹ï¼Œä½†å‡¡ä½¿ç”¨è¿‡ <code>frida-java-bridge</code>  çš„éƒ½ä¼šå­˜åœ¨ï¼Œä½†åœ¨æˆ‘æµ‹è¯• <code>Frida 16</code>  æœ€åä¸€ä¸ªç‰ˆæœ¬æ—¶ï¼ˆ16.7.19ï¼‰ï¼Œè¿™ä¸ªæ£€æµ‹ç‚¹å®Œå…¨å¤±æ•ˆäº†ã€‚å¤±æ•ˆåŸå› ååˆ†å¥‡ç‰¹ï¼Œè¿™ä¸ªå‡½æ•°å­—èŠ‚ç åœ¨ç¨‹åºé‡Œçš„æ£€æµ‹ä»£ç æ¥çœ‹æ˜¯å®Œå…¨æ­£å¸¸çš„ï¼Œä½†åœ¨æˆ‘ä½¿ç”¨ Frida æŠŠ <code>libart.so</code>  ç»™ <code>dump</code>  å‡ºæ¥æ—¶å´å‘ç°è¯¥ä½ç½®å·²ç»æ˜¯è¢«ä¿®æ”¹äº†ã€‚å½“æˆ‘å†åˆ‡æ¢åˆ° <code>Frida 16.5.6</code>  æ£€æµ‹ä»£ç æˆåŠŸæ£€æµ‹åˆ°å­—èŠ‚ç è¢«ä¿®æ”¹ã€‚åªèƒ½çŒœåˆ°æ–°ç‰ˆ <code>Frida</code>  åº”ç”¨äº†æŸäº›ç‰¹æ®Šä¿®æ”¹ï¼Œæ­¤æ£€æµ‹æœºåˆ¶å¯¹äºæ–°ç‰ˆ <code>Frida</code>  å¯èƒ½å¤±æ•ˆï¼Œæœ‰å¸ˆå‚…èƒ½è§£ç­”æˆ‘çš„ç–‘é—®çš„è¯ï¼Œå¯ä»¥åœ¨è¯„è®ºç•™è¨€ã€‚<br />\né¢˜ç›®ä¸­ç»•è¿‡è¿™ä¸ªæ£€æµ‹çš„å°±èƒ½è·å¾—çœŸæ­£çš„ <code>aeskey</code> ï¼Œå¦‚æœæ²¡ç»•è¿‡å°±ä¼šé€€å‡ºç¨‹åºã€‚</p>\n<p>æ¥ä¸‹æ¥å°±æ˜¯ç¨‹åºæœ€é‡è¦çš„éƒ¨åˆ†äº†ï¼Œåœ¨ <code>.init_proc</code>  æœ‰å¦‚ä¸‹ä»£ç </p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">init_proc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  FILE <span class=\"token operator\">*</span>v0<span class=\"token punctuation\">;</span> <span class=\"token comment\">// x0</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token class-name\">int8x16_t</span> v1<span class=\"token punctuation\">;</span> <span class=\"token comment\">// q1</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  __int64 v2<span class=\"token punctuation\">;</span> <span class=\"token comment\">// x19</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  __int64 v3<span class=\"token punctuation\">;</span> <span class=\"token comment\">// x21</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  v34 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token function\">_ReadStatusReg</span><span class=\"token punctuation\">(</span><span class=\"token function\">ARM64_SYSREG</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  v33 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>          <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>l<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>          <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_10250<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  v0 <span class=\"token operator\">=</span> <span class=\"token function\">dlopen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>v33<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>              <span class=\"token comment\">// libart.so</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  v1 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>l<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  v2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>__int64<span class=\"token punctuation\">)</span>v0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>s2 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v1<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_10150<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  v26 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v1<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_10270<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  v27 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v1<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_10100<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  v28 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v1<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_10180<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  v29 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v1<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_101D0<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  v30 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v1<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_10130<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  v31 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v1<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_10190<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  v32 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v1<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_10260<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  v3 <span class=\"token operator\">=</span> <span class=\"token function\">dlsym</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>__int64<span class=\"token punctuation\">)</span>v0<span class=\"token punctuation\">,</span> s2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                  <span class=\"token comment\">// _ZN3art11interpreter6DoCallILb0EEEbPNS_9ArtMethodEPNS_6ThreadERNS_11ShadowFrameEPKNS_11InstructionEtbPNS_6JValueE</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token operator\">!</span>v3 <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    v4 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>l<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>v17 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v4<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_10150<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    v18 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v4<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_10270<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    v19 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v4<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_10120<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    v20 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v4<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_101E0<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    v21 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v4<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_101A0<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    v22 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v4<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_10230<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    v23 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v4<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_10200<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    v24 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v4<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_101B0<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    v3 <span class=\"token operator\">=</span> <span class=\"token function\">dlsym</span><span class=\"token punctuation\">(</span>v2<span class=\"token punctuation\">,</span> v17<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                        <span class=\"token comment\">// _ZN3art11interpreter6DoCallILb0ELb0EEEbPNS_9ArtMethodEPNS_6ThreadERNS_11ShadowFrameEPKNS_11InstructionEtPNS_6JValueE</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>  v5 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>l<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>v17 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v5<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_10110<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>  v18 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v5<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_10210<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>  v19 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v5<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_10160<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>  off_41F40 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>_UNKNOWN <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token function\">dlsym</span><span class=\"token punctuation\">(</span>v2<span class=\"token punctuation\">,</span> v17<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>       <span class=\"token comment\">// _ZN3art9ArtMethod12PrettyMethodEb</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>  v6 <span class=\"token operator\">=</span> <span class=\"token function\">getpagesize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>  v7 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token function\">linux_eabi_syscall</span><span class=\"token punctuation\">(</span>__NR_mmap<span class=\"token punctuation\">,</span> <span class=\"token number\">0LL</span><span class=\"token punctuation\">,</span> v6<span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0LL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>  <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>v7<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> v6<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>  <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span>v7<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>shellcode_end_ <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>  jmp_addr_ <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>__int64<span class=\"token punctuation\">)</span>v7<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>v7<span class=\"token punctuation\">[</span><span class=\"token operator\">&amp;</span>the_func_addr_ <span class=\"token operator\">-</span> <span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> sub_1A51C<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>v7<span class=\"token punctuation\">[</span><span class=\"token operator\">&amp;</span>end_func_addr_ <span class=\"token operator\">-</span> <span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> sub_1A6E0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>v7<span class=\"token punctuation\">[</span><span class=\"token operator\">&amp;</span>retback_addr_ <span class=\"token operator\">-</span> <span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v3 <span class=\"token operator\">+</span> <span class=\"token number\">16</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>  v8 <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>ori_ins_set1_ <span class=\"token operator\">-</span> <span class=\"token operator\">&amp;</span>shellcode_start_ <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>v7<span class=\"token punctuation\">[</span><span class=\"token operator\">&amp;</span>ori_ins_set1_ <span class=\"token operator\">-</span> <span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>v3<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>v7<span class=\"token punctuation\">[</span>v8<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>v3 <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>  v9 <span class=\"token operator\">=</span> <span class=\"token function\">linux_eabi_syscall</span><span class=\"token punctuation\">(</span>__NR_mprotect<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token punctuation\">(</span>__int64<span class=\"token punctuation\">)</span>v6 <span class=\"token operator\">&amp;</span> v3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> v6<span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>v3 <span class=\"token operator\">=</span> trampoline_<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>v3 <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> jmp_addr_<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>  v10 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>l<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>  leave1 <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>shellcode_part2_ <span class=\"token operator\">-</span> <span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>v14 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v10<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_101C0<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>  v15 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v10<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_10140<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>  v16 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v10<span class=\"token punctuation\">,</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_10170<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>  v11 <span class=\"token operator\">=</span> <span class=\"token function\">dlsym</span><span class=\"token punctuation\">(</span>v2<span class=\"token punctuation\">,</span> v14<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                         <span class=\"token comment\">// _ZNK3art9OatHeader12IsDebuggableE</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>  v12 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token function\">linux_eabi_syscall</span><span class=\"token punctuation\">(</span>__NR_mmap<span class=\"token punctuation\">,</span> <span class=\"token number\">0LL</span><span class=\"token punctuation\">,</span> v6<span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0LL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>  <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>v12<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> v6<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>  <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span>v12<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>shellcode_end_ <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>  jmp_addr_ <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>__int64<span class=\"token punctuation\">)</span>v12<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>v12<span class=\"token punctuation\">[</span><span class=\"token operator\">&amp;</span>the_func_addr_ <span class=\"token operator\">-</span> <span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> sub_1A710<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>v12<span class=\"token punctuation\">[</span><span class=\"token operator\">&amp;</span>end_func_addr_ <span class=\"token operator\">-</span> <span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> sub_1A76C<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>v12<span class=\"token punctuation\">[</span><span class=\"token operator\">&amp;</span>retback_addr_ <span class=\"token operator\">-</span> <span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v11 <span class=\"token operator\">+</span> <span class=\"token number\">16</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>v12<span class=\"token punctuation\">[</span><span class=\"token operator\">&amp;</span>ori_ins_set1_ <span class=\"token operator\">-</span> <span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>v11<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>v12<span class=\"token punctuation\">[</span>v8<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>v11 <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>  result <span class=\"token operator\">=</span> <span class=\"token function\">linux_eabi_syscall</span><span class=\"token punctuation\">(</span>__NR_mprotect<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>v11 <span class=\"token operator\">&amp;</span> <span class=\"token operator\">-</span><span class=\"token punctuation\">(</span>__int64<span class=\"token punctuation\">)</span>v6<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> v6<span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>v11 <span class=\"token operator\">=</span> trampoline_<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>v11 <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> jmp_addr_<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>  leave2 <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>shellcode_part2_ <span class=\"token operator\">-</span> <span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>  <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>æœ‰å­—ç¬¦ä¸²æ··æ·†ï¼Œä»£ç ä½¿ç”¨ <code>neonæŒ‡ä»¤é›†</code> å¯¹å­—ç¬¦ä¸²è¿›è¡Œè§£å¯†ï¼Œ <code>veorq_s8</code>  å’Œ <code>vqtbl1q_s8</code> ï¼Œä¸€ä¸ªæ˜¯å¼‚æˆ–æŒ‡ä»¤ï¼Œä¸€ä¸ªæ˜¯å–è¡¨æ¢ä½æŒ‡ä»¤ï¼Œäº†è§£ä¸€ä¸‹å°±å¯ä»¥å†™å‡ºå­—ç¬¦ä¸²è§£å¯†è„šæœ¬ï¼Œç”¨ <code>Frida</code>   <code>hook init</code>  éœ€è¦ <code>Hookè¿æ¥å™¨</code> ä¹Ÿå¯ä»¥æ¢å¤å‡ºæ¥ã€‚</p>\n<p>æ¥ä¸‹æ¥åˆ†æå‡½æ•°ï¼Œé¦–å…ˆæ˜¯ <code>shellcode</code>  å…¨å±€å˜é‡ï¼Œè½¬åŒ–ä¸ºæ±‡ç¼–åå¯ä»¥çœ‹åˆ°ä¿æŠ¤ç°åœºçš„ <code>shellcode</code></p>\n<pre><code>\n.data:0000000000041C88\n.data:0000000000041C88                 MOV             X1, X30\n.data:0000000000041C8C                 STP             X1, X0, [SP,#arg_40]\n.data:0000000000041C90                 STP             XZR, X2, [SP,#arg_50]\n.data:0000000000041C94                 MOV             X30, X2\n.data:0000000000041C98                 LDP             X1, X0, [SP,#arg_30]\n.data:0000000000041C9C                 LDP             X3, X2, [SP,#arg_20]\n.data:0000000000041CA0                 SUB             SP, SP, #0x200\n.data:0000000000041CA4                 STP             Q0, Q1, [SP,#0x200+var_200]\n.data:0000000000041CA8                 STP             Q2, Q3, [SP,#0x200+var_1E0]\n.data:0000000000041CAC                 STP             Q4, Q5, [SP,#0x200+var_1C0]\n.data:0000000000041CB0                 STP             Q6, Q7, [SP,#0x200+var_1A0]\n.data:0000000000041CB4                 STP             X0, X1, [SP,#0x200+var_200]\n.data:0000000000041CB8                 STP             X2, X3, [SP,#0x200+var_1F0]\n.data:0000000000041CBC                 STP             X4, X5, [SP,#0x200+var_1E0]\n.data:0000000000041CC0                 STP             X6, X7, [SP,#0x200+var_1D0]\n.data:0000000000041CC4                 STP             X8, X9, [SP,#0x200+var_1C0]\n.data:0000000000041CC8                 STP             X10, X11, [SP,#0x200+var_1B0]\n.data:0000000000041CCC                 STP             X12, X13, [SP,#0x200+var_1A0]\n.data:0000000000041CD0                 STP             X14, X15, [SP,#0x200+var_190]\n.data:0000000000041CD4                 STP             X16, X17, [SP,#0x200+var_180]\n.data:0000000000041CD8                 STP             X18, X19, [SP,#0x200+var_170]\n.data:0000000000041CDC                 STP             X20, X21, [SP,#0x200+var_160]\n.data:0000000000041CE0                 STP             X22, X23, [SP,#0x200+var_150]\n.data:0000000000041CE4                 STP             X24, X25, [SP,#0x200+var_140]\n.data:0000000000041CE8                 STP             X26, X27, [SP,#0x200+var_130]\n.data:0000000000041CEC                 STP             X28, X29, [SP,#0x200+var_120]\n.data:0000000000041CF0                 STP             X30, XZR, [SP,#0x200+var_110]\n.data:0000000000041CF4                 ADD             X0, SP, #0x200+arg_0\n.data:0000000000041CF8                 ADR             X16, _the_func_addr_\n.data:0000000000041CFC                 LDR             X16, [X16]\n.data:0000000000041D00                 BLR             X16\n.data:0000000000041D04                 LDP             X0, X1, [SP,#0x200+var_200]\n.data:0000000000041D08                 LDP             X2, X3, [SP,#0x200+var_1F0]\n.data:0000000000041D0C                 LDP             X4, X5, [SP,#0x200+var_1E0]\n.data:0000000000041D10                 LDP             X6, X7, [SP,#0x200+var_1D0]\n.data:0000000000041D14                 LDP             X8, X9, [SP,#0x200+var_1C0]\n.data:0000000000041D18                 LDP             X10, X11, [SP,#0x200+var_1B0]\n.data:0000000000041D1C                 LDP             X12, X13, [SP,#0x200+var_1A0]\n.data:0000000000041D20                 LDP             X14, X15, [SP,#0x200+var_190]\n.data:0000000000041D24                 LDP             X16, X17, [SP,#0x200+var_180]\n.data:0000000000041D28                 LDP             X18, X19, [SP,#0x200+var_170]\n.data:0000000000041D2C                 LDP             X20, X21, [SP,#0x200+var_160]\n.data:0000000000041D30                 LDP             X22, X23, [SP,#0x200+var_150]\n.data:0000000000041D34                 LDP             X24, X25, [SP,#0x200+var_140]\n.data:0000000000041D38                 LDP             X26, X27, [SP,#0x200+var_130]\n.data:0000000000041D3C                 LDP             X28, X29, [SP,#0x200+var_120]\n.data:0000000000041D40                 LDP             X30, XZR, [SP,#0x200+var_110]\n.data:0000000000041D44                 LDP             Q0, Q1, [SP,#0x200+var_200]\n.data:0000000000041D48                 LDP             Q2, Q3, [SP,#0x200+var_1E0]\n.data:0000000000041D4C                 LDP             Q4, Q5, [SP,#0x200+var_1C0]\n.data:0000000000041D50                 LDP             Q6, Q7, [SP,#0x200+var_1A0]\n.data:0000000000041D54                 ADD             SP, SP, #0x200\n.data:0000000000041D58                 LDP             X7, X6, [SP,#arg_0]\n.data:0000000000041D5C                 LDP             X5, X4, [SP,#arg_10]\n.data:0000000000041D60                 LDP             X3, X2, [SP,#arg_20]\n.data:0000000000041D64                 LDP             X1, X0, [SP,#arg_30]\n.data:0000000000041D68                 LDP             XZR, X30, [SP,#arg_50]\n.data:0000000000041D6C                 ADD             SP, SP, #0x60 ; '`'\n.data:0000000000041D70\n.data:0000000000041D70                 EXPORT _ori_ins_set1_\n</code></pre>\n<p>æœ‰ä¿æŠ¤ç°åœºçš„ <code>shellcode</code> ï¼Œæœ‰ <code>jmp_addr_</code> å…¨å±€å˜é‡ï¼Œè¿˜æœ‰ä»¥ä¸‹æŠŠå‡½æ•°èµ‹å€¼åˆ°å˜é‡çš„æ“ä½œï¼Œå¯ä»¥æƒ³åˆ°æ˜¯ <code>inlinehook</code>  äº†</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>jmp_addr_ <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>__int64<span class=\"token punctuation\">)</span>v7<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>v7<span class=\"token punctuation\">[</span><span class=\"token operator\">&amp;</span>the_func_addr_ <span class=\"token operator\">-</span> <span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> sub_1A51C<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>v7<span class=\"token punctuation\">[</span><span class=\"token operator\">&amp;</span>end_func_addr_ <span class=\"token operator\">-</span> <span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> sub_1A6E0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>v7<span class=\"token punctuation\">[</span><span class=\"token operator\">&amp;</span>retback_addr_ <span class=\"token operator\">-</span> <span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v3 <span class=\"token operator\">+</span> <span class=\"token number\">16</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  v8 <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>ori_ins_set1_ <span class=\"token operator\">-</span> <span class=\"token operator\">&amp;</span>shellcode_start_ <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>Hook çš„ç›®æ ‡è‚¯å®šæ˜¯é‚£äº› C è‰¹ç¬¦å·ï¼Œå¯ä»¥æ¢³ç†ä¸€ä¸‹æµç¨‹ï¼š</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>dl <span class=\"token operator\">=</span> <span class=\"token function\">fk_dlopen</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"libart.so\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>docall_sym <span class=\"token operator\">=</span> <span class=\"token function\">fk_dlsym</span><span class=\"token punctuation\">(</span>dl<span class=\"token punctuation\">,</span><span class=\"token string\">\"...DoCall...\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>docall_sym <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  docall_sym <span class=\"token operator\">=</span> <span class=\"token function\">fk_dlsym</span><span class=\"token punctuation\">(</span>dl<span class=\"token punctuation\">,</span><span class=\"token string\">\"...DoCall2...\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>prettymethod_sym <span class=\"token operator\">=</span> <span class=\"token function\">fk_dlsym</span><span class=\"token punctuation\">(</span>dl<span class=\"token punctuation\">,</span><span class=\"token string\">\"...PrettyMethod...\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">hook</span><span class=\"token punctuation\">(</span>docall_sym<span class=\"token punctuation\">,</span>enter_fun<span class=\"token punctuation\">,</span>leave_fun<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>IsDebuggable_sym <span class=\"token operator\">=</span> <span class=\"token function\">fk_dlsym</span><span class=\"token punctuation\">(</span>dl<span class=\"token punctuation\">,</span><span class=\"token string\">\"...IsDebuggable...\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">hook</span><span class=\"token punctuation\">(</span>IsDebuggable_sym<span class=\"token punctuation\">,</span>enter_fun2<span class=\"token punctuation\">,</span>leave_fun2<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>å¯¹äº  <code>IsDebuggable</code></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>v12<span class=\"token punctuation\">[</span><span class=\"token operator\">&amp;</span>the_func_addr_ <span class=\"token operator\">-</span> <span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> sub_1A710<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>v12<span class=\"token punctuation\">[</span><span class=\"token operator\">&amp;</span>end_func_addr_ <span class=\"token operator\">-</span> <span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> sub_1A76C<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>çœ‹ <code>shellcode</code>  å¯ä»¥çŸ¥é“ç¬¬ä¸€ä¸ªæ˜¯ <code>onEnter</code> ï¼Œç¬¬äºŒä¸ªæ˜¯ <code>onLeave</code> ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°å¹¶æ²¡æœ‰å¤ªå¤šæ›´æ”¹æ“ä½œï¼Œä»… <code>sub_1A710</code>  æ›´æ”¹å‡½æ•°è¿”å›æŒ‡ä¸º 1ã€‚ä¸ºä»€ä¹ˆè¦ Hook è¿™ä¸ªå‡½æ•°ï¼Ÿè¿™é‡Œæ˜¯ä¸ºäº†æœç»ä»£ç èµ° <span class=\"exturl\" data-url=\"aHR0cHM6Ly9zb3VyY2UuYW5kcm9pZC5nb29nbGUuY24vZG9jcy9jb3JlL3J1bnRpbWUvaml0LWNvbXBpbGVyP2hsPXpoLWNu\">JIT</span> ï¼Œå¤§å®¶éƒ½çŸ¥é“ï¼Œå®‰å“å­—èŠ‚ç æœ€ç»ˆæ‰§è¡Œæœ‰ä¸‰ç§è·¯å¾„ï¼šè§£é‡Šæ¨¡å¼ï¼Œ <code>JIT</code> ï¼Œå’Œ <code>AOT</code> <br />\n<img data-src=\"https://source.android.google.cn/docs/core/runtime/images/jit-arch.png?hl=zh-cn\" alt=\"JIT\" /><br />\n è§£é‡Šæ¨¡å¼é¡¾åæ€ä¹‰å°±æ˜¯ <code>VM</code>  è§£æå­—èŠ‚ç ç„¶åè¿è¡Œï¼ˆæœ¬é¢˜ç›®éœ€è¦èµ°è¿™ç§æ¨¡å¼ï¼‰ï¼Œ <code>JIT</code>  å°±æ˜¯è¿è¡Œæ—¶ç¼–è¯‘æˆæœºæ¢°ç ï¼Œ <code>AOT</code>  å°±æ˜¯è¿è¡Œå‰ç¼–è¯‘æˆæœºæ¢°ç ã€‚åä¸¤ç§ç¼–è¯‘æ¨¡å¼å…±ç”¨ä¸€ä¸ªç¼–è¯‘å™¨ã€‚æœ¬æ¬¡çš„ <code>Apk</code>  æ˜¯ <code>Release</code>  æ„å»ºçš„é»˜è®¤ä¼šä½¿ <code>Java</code>  ä»£ç çš„æ‰§è¡Œèµ° <code>AOT</code> ï¼ˆ <code>AOT</code>  æ–‡ä»¶ä¼šåœ¨ <code>Apk</code>  å®‰è£…æ—¶ç”Ÿæˆï¼ŒåŒæ—¶åœ¨ <code>Apk</code>  è¿è¡Œæ—¶é€šè¿‡æ”¶é›†ä¿¡æ¯ä¼˜åŒ– <code>oat</code>  æ–‡ä»¶ï¼‰ï¼Œå¦‚æœä¸è¿›è¡Œå¤„ç†ï¼Œåé¢çš„ <code>DoCall</code>  æ˜¯ä¸ä¼šè¢«è§¦å‘çš„ï¼ˆå› ä¸º <code>DoCall</code>  æ˜¯è§£é‡Šæ¨¡å¼æ‰ä¼šç”¨åˆ°çš„ï¼Œè¿™ä¸€ç‚¹ä» <code>art::interpreter::DoCall</code>  è¿™ä¸ªå‰ç¼€å°±å¯ä»¥çœ‹å‡ºæ¥ï¼‰ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯å¦‚æœä½ å°† <code>Apk</code>  ç¼–è¯‘ä¸º <code>Debug</code>  å°†ä¸ä¼šè§¦å‘ <code>AOT</code> ï¼Œä½†æˆ–è®¸ä¼šè§¦å‘ <code>JIT</code> ï¼Œæƒè¡¡ä¸‹è¿˜æ˜¯ä»¥ <code>Release</code>  ä¸ºç›®æ ‡äº†ï¼Œä¹Ÿæ˜¯ä¸ºäº†å­¦ä¹ å§å“ˆå“ˆã€‚</p>\n<p>å½“åˆç«‹é©¬æƒ³åˆ°ï¼Œ <code>DEX</code>  å¦‚æœæ˜¯åœ¨ <code>apk</code>  å®‰è£…æ‰ä¼šæŒ‡å‡º <code>dex2oat</code>  é‚£ä¸ºä»€ä¹ˆä¸ç›´æ¥é€šè¿‡åŠ¨æ€åŠ è½½ <code>Dex</code>  ç»•è¿‡ <code>AOT</code>  å‘¢ï¼Œæˆ‘é©¬ä¸ŠåŠ è½½é©¬ä¸Šä½¿ç”¨çš„ <code>Dex</code>  ä½ æ€»ä¸å¯èƒ½ä¼˜åŒ–äº†å§ã€‚ä½†è¿™ä¸ªæ€è·¯æ˜¯ä¸å¯è¡Œçš„ï¼ŒåŠ¨æ€åŠ è½½ <code>Dex</code>  ä¸èµ° <code>oat</code>  åªæœ‰ä¸€ç§æƒ…å†µï¼šä½¿ç”¨ <code>InMemoryDexClassLoader</code> ï¼Œä½†ä» <code>Android10</code>  å¼€å§‹ï¼Œ <code>InMemoryDexClassLoader</code>  åŠ è½½çš„ <code>Dex</code>  æ–‡ä»¶ä¹Ÿä¼šèµ° <code>AOT</code>  æµç¨‹ã€‚é‚£ä¹ˆå‰©ä¸‹çš„æ–¹æ³•å°±æ˜¯  <code>Hook</code>  AOT åŠ è½½æµç¨‹ï¼Œéœ€è¦æ‰¾ä¸€ä¸ªå¿…å®šå¯¼å‡º <code>libart.so</code>  å‡½æ•°æ¥å®æ–½è®¡åˆ’ï¼Œæ‰“å¼€ AOSP çœ‹çœ‹ï¼Œä½†éšå³å‘ç°å¤§éƒ¨åˆ†ç¬¦å·éƒ½æ˜¯ <code>HIDDEN</code>  çš„ï¼Œèƒ½ä½¿ç”¨çš„ç¬¦å·å°‘ä¹‹åˆå°‘ï¼Œåˆç”±äºé¢˜ç›®çš„ <code>hook</code>  ç¨‹åºæ˜¯åœ¨ç‚¹å‡»åå¯åŠ¨çš„ï¼Œå‡ ä¹å¾ˆéš¾æ‰¾åˆ°ç¬¦åˆè¦æ±‚çš„ <code>Hook</code>  ç‚¹ã€‚éšååœ¨æ‹·æ‰“ ai çš„æ—¶å€™å‘ç° <code>_ZNK3art9OatHeader12IsDebuggableE</code> ï¼Œå°è¯•åå‘ç°èƒ½åœ¨ <code>Release</code>  æ‰“åŒ…ä½¿ <code>DoCall</code>  è¢« <code>Hook</code>  åˆ°ï¼Œåœ¨ <code>a11ï½a15</code>  çš„è®¾å¤‡æµ‹è¯•ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œç”±äº ddl ä¸´è¿‘æ²¡æ·±è¿½ç©¶å°±ç”¨ä¸Šäº†ã€‚</p>\n<p>å¯¹äº <code>DoCall</code></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>v7<span class=\"token punctuation\">[</span><span class=\"token operator\">&amp;</span>the_func_addr_ <span class=\"token operator\">-</span> <span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> sub_1A51C<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>v7<span class=\"token punctuation\">[</span><span class=\"token operator\">&amp;</span>end_func_addr_ <span class=\"token operator\">-</span> <span class=\"token operator\">&amp;</span>shellcode_start_<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> sub_1A6E0<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>åªåˆ†æ <code>sub_1A51C</code>  å³å¯</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> __fastcall <span class=\"token function\">sub_1A51C</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span>a1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  __int64 v2<span class=\"token punctuation\">;</span> <span class=\"token comment\">// x21</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  __int64 v3<span class=\"token punctuation\">;</span> <span class=\"token comment\">// x21</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token class-name\">int8x16_t</span> v4<span class=\"token punctuation\">;</span> <span class=\"token comment\">// q0</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token class-name\">int8x16_t</span> v5<span class=\"token punctuation\">;</span> <span class=\"token comment\">// q3</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token class-name\">int8x16_t</span> v6<span class=\"token punctuation\">;</span> <span class=\"token comment\">// q1</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>v7<span class=\"token punctuation\">;</span> <span class=\"token comment\">// x19</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token class-name\">size_t</span> v8<span class=\"token punctuation\">;</span> <span class=\"token comment\">// x1</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  __int64 i<span class=\"token punctuation\">;</span> <span class=\"token comment\">// x9</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  __int16 v10<span class=\"token punctuation\">;</span> <span class=\"token comment\">// w8</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token keyword\">int</span> v11<span class=\"token punctuation\">;</span> <span class=\"token comment\">// w0</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  __int16 v12<span class=\"token punctuation\">;</span> <span class=\"token comment\">// w13</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  __int128 v13<span class=\"token punctuation\">;</span> <span class=\"token comment\">// q1</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  _OWORD <span class=\"token operator\">*</span>v14<span class=\"token punctuation\">;</span> <span class=\"token comment\">// x8</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  __int128 v15<span class=\"token punctuation\">;</span> <span class=\"token comment\">// q0</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  __int128 v16<span class=\"token punctuation\">;</span> <span class=\"token comment\">// q2</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  __int128 v17<span class=\"token punctuation\">;</span> <span class=\"token comment\">// q3</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  __int128 v18<span class=\"token punctuation\">;</span> <span class=\"token comment\">// q0</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  __int128 v19<span class=\"token punctuation\">;</span> <span class=\"token comment\">// q2</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  __int128 v20<span class=\"token punctuation\">;</span> <span class=\"token comment\">// q3</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>v21<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// [xsp+8h] [xbp-48h] BYREF</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>v22<span class=\"token punctuation\">;</span> <span class=\"token comment\">// [xsp+18h] [xbp-38h]</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  <span class=\"token keyword\">char</span> needle<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// [xsp+20h] [xbp-30h] BYREF</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>  <span class=\"token keyword\">char</span> v24<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// [xsp+30h] [xbp-20h] BYREF</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  __int64 v25<span class=\"token punctuation\">;</span> <span class=\"token comment\">// [xsp+48h] [xbp-8h]</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  v25 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token function\">_ReadStatusReg</span><span class=\"token punctuation\">(</span><span class=\"token function\">ARM64_SYSREG</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>  v2 <span class=\"token operator\">=</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_QWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token function\">__emutls_get_address</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>_emutls_v_ori_lr1<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> v2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>  v3 <span class=\"token operator\">=</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>  <span class=\"token function\">prettymethod_sym</span><span class=\"token punctuation\">(</span>v21<span class=\"token punctuation\">,</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0LL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>  v4 <span class=\"token operator\">=</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_101F0<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>  v5 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>l<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>  v6 <span class=\"token operator\">=</span> <span class=\"token function\">vqtbl1q_s8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>xmmword_10240<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span><span class=\"token punctuation\">)</span>shellcode_end_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>__int64<span class=\"token punctuation\">)</span>v21<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    v7 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>v22<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>  <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    v7 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>v21 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>needle <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v5<span class=\"token punctuation\">,</span> v4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>  <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int8x16_t</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>v24 <span class=\"token operator\">=</span> <span class=\"token function\">veorq_s8</span><span class=\"token punctuation\">(</span>v5<span class=\"token punctuation\">,</span> v6<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> v7 <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>  <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token function\">strstr</span><span class=\"token punctuation\">(</span>v7<span class=\"token punctuation\">,</span> needle<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span>                   <span class=\"token comment\">// gic.toB</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>      qword_41F58 <span class=\"token operator\">=</span> v3<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>      v8 <span class=\"token operator\">=</span> <span class=\"token function\">getpagesize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0LL</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">!=</span> <span class=\"token number\">160</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">+=</span> <span class=\"token number\">2LL</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        v11 <span class=\"token operator\">=</span> <span class=\"token function\">linux_eabi_syscall</span><span class=\"token punctuation\">(</span>__NR_mprotect<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token punctuation\">(</span>__int64<span class=\"token punctuation\">)</span>v8 <span class=\"token operator\">&amp;</span> v3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> v8<span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        v12 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_WORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>v3 <span class=\"token operator\">+</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_WORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>xmmword_41F60 <span class=\"token operator\">+</span> i<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> v12<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>v12 <span class=\"token operator\">==</span> <span class=\"token number\">179</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>          v10 <span class=\"token operator\">=</span> v12 <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xFFB2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>          v10 <span class=\"token operator\">=</span> v12<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>v12 <span class=\"token operator\">==</span> <span class=\"token number\">179</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>v10 <span class=\"token operator\">==</span> <span class=\"token number\">224</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int8<span class=\"token punctuation\">)</span>v10 <span class=\"token operator\">==</span> <span class=\"token number\">224</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>            v10 <span class=\"token operator\">|=</span> <span class=\"token number\">2u</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>          <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_WORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>v3 <span class=\"token operator\">+</span> i<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> v10<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token function\">strstr</span><span class=\"token punctuation\">(</span>v7<span class=\"token punctuation\">,</span> v24<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span>                 <span class=\"token comment\">// gic.fi</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>      v13 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_OWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>algn_41F70<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>      v14 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>_OWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>qword_41F58<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>      <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_OWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>qword_41F58 <span class=\"token operator\">=</span> xmmword_41F60<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>      v14<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v13<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>      v15 <span class=\"token operator\">=</span> unk_41FB0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>      v17 <span class=\"token operator\">=</span> xmmword_41F80<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>      v16 <span class=\"token operator\">=</span> unk_41F90<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>      v14<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> xmmword_41FA0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>      v14<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v15<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>      v14<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v17<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>      v14<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v16<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>      v18 <span class=\"token operator\">=</span> unk_41FF0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>      v20 <span class=\"token operator\">=</span> xmmword_41FC0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>      v19 <span class=\"token operator\">=</span> unk_41FD0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>      v14<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> xmmword_41FE0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>      v14<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v18<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>      v14<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v20<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>      v14<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v19<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>è§£å¯†å­—ç¬¦ä¸²å¯ä»¥å¾—åˆ° <code>gic.toB</code>  å’Œ <code>gic.fi</code> ï¼Œå¯¹åº” <code>magic.fixKey</code>  å’Œ <code>magic.toByteArray</code> ï¼Œç»“åˆ C è‰¹å‡½æ•° <code>DoCall</code> ï¼Œå¯ä»¥çŒœæµ‹ï¼ŒJava å±‚ä»£ç åœ¨æ‰§è¡Œæ—¶ï¼Œä¼šè¢«è¿™ä¸ª <code>onEnter</code>  è¿›è¡ŒæŸç§å¤„ç†ã€‚<br />\næ ¹æ®ç¬¦å·å¯ä»¥å®šä½åˆ°è¿™ä¸ªå‡½æ•° <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jcy5hbmRyb2lkLmNvbS9hbmRyb2lkL3BsYXRmb3JtL3N1cGVycHJvamVjdC9tYWluLysvbWFpbjphcnQvcnVudGltZS9pbnRlcnByZXRlci9pbnRlcnByZXRlcl9jb21tb24uY2M7ZHJjPTYxMTk3MzY0MzY3YzllNDA0YzdkYTY5MDA2NThmMWIxNmM0MmQwZGE7bD0xMzU2P3E9SW50ZXJwcmV0ZXJfY29tbW8mYW1wO3NzPWFuZHJvaWQlMkZwbGF0Zm9ybSUyRnN1cGVycHJvamVjdCUyRm1haW4mYW1wO2hsPXpoLWNu\">Aosp DoCall</span><br />\n ä»¥ä¸‹è§£é‡Šæ¥è‡ª <code>Deepseek</code></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> * æ‰§è¡Œæ–¹æ³•è°ƒç”¨ - ART è§£é‡Šå™¨æ ¸å¿ƒæ–¹æ³•è°ƒç”¨ä¾‹ç¨‹</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> * å¤„ç†æ‰€æœ‰ invoke-XXX æŒ‡ä»¤çš„å®é™…è°ƒç”¨åˆ†æ´¾</pre></td></tr><tr><td data-num=\"4\"></td><td><pre> * </pre></td></tr><tr><td data-num=\"5\"></td><td><pre> * @param called_method  ç›®æ ‡æ–¹æ³•å¯¹è±¡æŒ‡é’ˆï¼Œå·²è§£æå¥½çš„è¦è°ƒç”¨çš„æ–¹æ³•</pre></td></tr><tr><td data-num=\"6\"></td><td><pre> * @param self          å½“å‰çº¿ç¨‹å¯¹è±¡æŒ‡é’ˆ</pre></td></tr><tr><td data-num=\"7\"></td><td><pre> * @param shadow_frame  å½“å‰æ ˆå¸§å¼•ç”¨ï¼ŒåŒ…å«å±€éƒ¨å˜é‡å’Œæ“ä½œæ•°æ ˆ</pre></td></tr><tr><td data-num=\"8\"></td><td><pre> * @param inst          å½“å‰æŒ‡ä»¤æŒ‡é’ˆï¼ŒæŒ‡å‘æ­£åœ¨æ‰§è¡Œçš„ invoke æŒ‡ä»¤</pre></td></tr><tr><td data-num=\"9\"></td><td><pre> * @param inst_data     æŒ‡ä»¤æ•°æ®ï¼Œå·²è§£ç çš„æŒ‡ä»¤æ“ä½œæ•°</pre></td></tr><tr><td data-num=\"10\"></td><td><pre> * @param is_string_init æ˜¯å¦ä¸ºå­—ç¬¦ä¸²æ„é€ å‡½æ•°ç‰¹æ®Šå¤„ç†</pre></td></tr><tr><td data-num=\"11\"></td><td><pre> * @param result        æ–¹æ³•è¿”å›å€¼å­˜å‚¨ä½ç½®</pre></td></tr><tr><td data-num=\"12\"></td><td><pre> * @return bool         è°ƒç”¨æ˜¯å¦æˆåŠŸæ‰§è¡Œ</pre></td></tr><tr><td data-num=\"13\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>bool <span class=\"token function\">DoCall</span><span class=\"token punctuation\">(</span>ArtMethod<span class=\"token operator\">*</span> called_method<span class=\"token punctuation\">,</span>    <span class=\"token comment\">// ç›®æ ‡æ–¹æ³•</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            Thread<span class=\"token operator\">*</span> self<span class=\"token punctuation\">,</span>                <span class=\"token comment\">// å½“å‰çº¿ç¨‹  </span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            ShadowFrame<span class=\"token operator\">&amp;</span> shadow_frame<span class=\"token punctuation\">,</span>   <span class=\"token comment\">// å½“å‰æ ˆå¸§</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token keyword\">const</span> Instruction<span class=\"token operator\">*</span> inst<span class=\"token punctuation\">,</span>     <span class=\"token comment\">// è°ƒç”¨æŒ‡ä»¤</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token class-name\">uint16_t</span> inst_data<span class=\"token punctuation\">,</span>          <span class=\"token comment\">// æŒ‡ä»¤æ•°æ®</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            bool is_string_init<span class=\"token punctuation\">,</span>         <span class=\"token comment\">// å­—ç¬¦ä¸²æ„é€ æ ‡è®°</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            JValue<span class=\"token operator\">*</span> result<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>            <span class=\"token comment\">// è¿”å›å€¼å­˜å‚¨</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token comment\">// ä»æŒ‡ä»¤ä¸­è·å–å‚æ•°ä¸ªæ•°ï¼ˆåŒºåˆ† range å’Œé range æ ¼å¼ï¼‰</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  <span class=\"token keyword\">const</span> <span class=\"token class-name\">uint16_t</span> number_of_inputs <span class=\"token operator\">=</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>      <span class=\"token punctuation\">(</span>is_range<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> inst<span class=\"token operator\">-></span><span class=\"token function\">VRegA_3rc</span><span class=\"token punctuation\">(</span>inst_data<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> inst<span class=\"token operator\">-></span><span class=\"token function\">VRegA_35c</span><span class=\"token punctuation\">(</span>inst_data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  <span class=\"token comment\">// å‚æ•°å¯„å­˜å™¨å¤„ç†ï¼šé range ä½¿ç”¨æ•°ç»„ï¼Œrange ä½¿ç”¨è¿ç»­å¯„å­˜å™¨æ®µ</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>  <span class=\"token class-name\">uint32_t</span> arg<span class=\"token punctuation\">[</span>Instruction<span class=\"token operator\">::</span>kMaxVarArgRegs<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  <span class=\"token class-name\">uint32_t</span> vregC <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>is_range<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    vregC <span class=\"token operator\">=</span> inst<span class=\"token operator\">-></span><span class=\"token function\">VRegC_3rc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">//range æ ¼å¼ï¼šèµ·å§‹å¯„å­˜å™¨ç¼–å·</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    vregC <span class=\"token operator\">=</span> inst<span class=\"token operator\">-></span><span class=\"token function\">VRegC_35c</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// é range æ ¼å¼ï¼šå‚æ•°å¯„å­˜å™¨æ•°ç»„</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    inst<span class=\"token operator\">-></span><span class=\"token function\">GetVarArgs</span><span class=\"token punctuation\">(</span>arg<span class=\"token punctuation\">,</span> inst_data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>  <span class=\"token comment\">// è°ƒç”¨é€šç”¨å¤„ç†é€»è¾‘</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>  <span class=\"token keyword\">return</span> DoCallCommon<span class=\"token operator\">&lt;</span>is_range<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>called_method<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">,</span> shadow_frame<span class=\"token punctuation\">,</span> result<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>                               number_of_inputs<span class=\"token punctuation\">,</span> arg<span class=\"token punctuation\">,</span> vregC<span class=\"token punctuation\">,</span> is_string_init<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>è¿™é‡Œé¢æœ‰ä¸¤ä¸ªå‚æ•°å¾ˆé‡è¦ï¼Œä¸€ä¸ªæ˜¯ <code>called_method</code> ï¼Œä¸€ä¸ªæ˜¯ <code>inst</code> ã€‚<br />\n <code>called_method</code>  åŒ…å«è¢«è°ƒç”¨è€…æ‰€æœ‰ä¿¡æ¯ï¼Œ <code>AOSP</code>  æœ‰å¦‚ä¸‹ä»£ç ï¼Œé€šè¿‡ ä¹‹å‰è·å¾—çš„ <code>prettymethod_sym</code>  å¯ä»¥ç›´æ¥è·å¾—è¢«è°ƒå‡½æ•°çš„å‡½æ•°å</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>std<span class=\"token operator\">::</span>string ArtMethod<span class=\"token operator\">::</span><span class=\"token function\">PrettyMethod</span><span class=\"token punctuation\">(</span>ArtMethod<span class=\"token operator\">*</span> m<span class=\"token punctuation\">,</span> bool with_signature<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>m <span class=\"token operator\">==</span> nullptr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token string\">\"null\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token keyword\">return</span> m<span class=\"token operator\">-></span><span class=\"token function\">PrettyMethod</span><span class=\"token punctuation\">(</span>with_signature<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>è€Œ <code>inst</code>  å°±æœ‰ç”¨äº†ï¼Œ <code>class Instruction</code>  æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºè§£é‡Šæ¨¡å¼å­—èŠ‚ç è§£æçš„ä¸€ä¸ªç±» <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jcy5hbmRyb2lkLmNvbS9hbmRyb2lkL3BsYXRmb3JtL3N1cGVycHJvamVjdC9tYWluLysvbWFpbjphcnQvbGliZGV4ZmlsZS9kZXgvZGV4X2luc3RydWN0aW9uLmg7bD0xODtkcmM9NjExOTczNjQzNjdjOWU0MDRjN2RhNjkwMDY1OGYxYjE2YzQyZDBkYT9xPWRleF9pbnN0cnVjdGlvbi5oJmFtcDtzcz1hbmRyb2lkJTJGcGxhdGZvcm0lMkZzdXBlcnByb2plY3QlMkZtYWluJmFtcDtobD16aC1jbg==\">Instruction Aosp</span></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">static</span> <span class=\"token keyword\">const</span> Instruction<span class=\"token operator\">*</span> <span class=\"token function\">At</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token class-name\">uint16_t</span><span class=\"token operator\">*</span> code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">DCHECK</span><span class=\"token punctuation\">(</span>code <span class=\"token operator\">!=</span> nullptr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">return</span> reinterpret_cast<span class=\"token operator\">&lt;</span><span class=\"token keyword\">const</span> Instruction<span class=\"token operator\">*</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token comment\">// Reads an instruction out of the stream from the current address plus an offset.</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token keyword\">const</span> Instruction<span class=\"token operator\">*</span> <span class=\"token function\">RelativeAt</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">int32_t</span> offset<span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> WARN_UNUSED <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token function\">At</span><span class=\"token punctuation\">(</span>reinterpret_cast<span class=\"token operator\">&lt;</span><span class=\"token keyword\">const</span> <span class=\"token class-name\">uint16_t</span><span class=\"token operator\">*</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>this<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> offset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token comment\">// Returns a pointer to the next instruction in the stream.</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token keyword\">const</span> Instruction<span class=\"token operator\">*</span> <span class=\"token function\">Next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token function\">RelativeAt</span><span class=\"token punctuation\">(</span><span class=\"token function\">SizeInCodeUnits</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>çœ‹åˆ°è¿™äº›ä»£ç å°±å¯ä»¥ç§’æ‡‚äº†ï¼Œåªè¦æŠŠå†…å­˜ä¸­å‡½æ•°çš„å­—èŠ‚ç è½¬ä¸º <code>Instruction*</code> ï¼Œå°±å¯ä»¥åˆ©ç”¨å…¶ä¸­å‡½æ•°è¯»å–æ“ä½œç å’Œæ“ä½œæ•°ã€‚é‚£ä¹ˆé€šè¿‡ <code>inst</code>  æ‹¿åˆ°çš„æŒ‡é’ˆå°±æ˜¯ <code>Dex</code>  çš„æŒ‡é’ˆï¼Œåªè¦æŠŠæŒ‡é’ˆå‘å‰å›æº¯åˆ° <code>Dex</code>  å¤´å°±å¯ä»¥æ“ä½œæ­£åœ¨è¿è¡Œçš„æ•´ä¸ª <code>Dex</code>  æ–‡ä»¶ã€‚<br />\n <code>ddl</code>  è¿‘åœ¨çœ¼å‰ï¼Œæ²¡æ—¶é—´å†™ä»€ä¹ˆåä¸½çš„ä¿®æ”¹ä»£ç çš„ï¼Œä½¿ç”¨äº†æœ€ç®€å•çš„ä¿®æ”¹æ–¹å¼ï¼Œé¢˜ç›®æ˜¯è®¾ç½®ä¸€ä¸ªæ¯”å¯¹å™¨ï¼Œé€šè¿‡æ¯”å¯¹æ­£åœ¨æ‰§è¡Œçš„ <code>Java</code>  å‡½æ•°åæ¥ä¿®æ”¹å­—èŠ‚ç ã€‚å½“æ‰§è¡Œåˆ° <code>call magic.fixKey</code>  å°±å°†è¯¥å­—èŠ‚ç ä¸‹æ–¹çš„é€»è¾‘ä¿®æ”¹æ‰ï¼Œç›´åˆ°è¢«ä¿®æ”¹çš„é€»è¾‘æ‰§è¡Œå®Œæ¯•è¿è¡Œåˆ° <code>call magic.toByteArray</code>  å†æŠŠæ”¹æ‰çš„å­—èŠ‚ç æ”¹å›æ¥ã€‚</p>\n<p>è¿™é‡Œè§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆæˆ‘é€‰ <code>DoCall</code>  ä½†æ˜¯æ²¡æœ‰é€‰ <code>ArtMethod::Invoke</code> ï¼Œ <code>Invoke</code>  å‡½æ•°å¤´å¦‚ä¸‹</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> ArtMethod<span class=\"token operator\">::</span><span class=\"token function\">Invoke</span><span class=\"token punctuation\">(</span>Thread<span class=\"token operator\">*</span> self<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint32_t</span><span class=\"token operator\">*</span> args<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint32_t</span> args_size<span class=\"token punctuation\">,</span> JValue<span class=\"token operator\">*</span> result<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> shorty<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°æ˜¯åœ¨å‡½æ•° <code>DoCall</code>  çš„ä¸‹å±‚æ‰§è¡Œï¼Œå¯ä»¥é€šè¿‡ <code>this</code>  æ‹¿åˆ° <code>ArtMethod</code>  å†è¿›ä¸€æ­¥è§£æ <code>ArtMethod</code>  æ‹¿åˆ° <code>GetCodeItem()</code>  åœ¨è§£æ <code>codeitem</code>  ç»“æ„æ‹¿åˆ° <code>Instruction</code> ï¼Œè¿™ä¸ªå­—èŠ‚ç è·å–æµç¨‹å¤ªè¿‡å¤æ‚ï¼Œå¯¹äº <code>Hook</code>  æ¥è¯´å¦‚æœæŸäº›åç§»æ˜¯ç¡¬ç¼–ç ï¼Œé‚£æ˜¯å¾ˆéš¾é€‚é…å¤šä¸ªç‰ˆæœ¬å®‰å“çš„ã€‚</p>\n<p>ç”¨ä»€ä¹ˆæ”¹çš„å·²ç»çŸ¥é“äº†ï¼Œé‚£åˆ°åº•æ˜¯æ€ä¹ˆæ”¹çš„å‘¢ï¼Ÿ<br />\nå‚ç…§è¿™ä¸ªè¡¨æ ¼ <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jcy5hbmRyb2lkLmNvbS9hbmRyb2lkL3BsYXRmb3JtL3N1cGVycHJvamVjdC9tYWluLysvbWFpbjphcnQvbGliZGV4ZmlsZS9kZXgvZGV4X2luc3RydWN0aW9uX2xpc3QuaDtsPTE4O2RyYz02MTE5NzM2NDM2N2M5ZTQwNGM3ZGE2OTAwNjU4ZjFiMTZjNDJkMGRhP3E9ZGV4X2luc3RydWN0aW9uX2xpc3QuaCZhbXA7c3E9JmFtcDtobD16aC1jbg==\">dex_instruction_list Aosp</span></p>\n<p><code>hex(179)-&gt;0xd3</code> <br />\n <code>hex(224)-&gt;0xe0</code></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">V</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xB2</span><span class=\"token punctuation\">,</span> MUL_INT_2ADDR<span class=\"token punctuation\">,</span> <span class=\"token string\">\"mul-int/2addr\"</span><span class=\"token punctuation\">,</span> k12x<span class=\"token punctuation\">,</span> kIndexNone<span class=\"token punctuation\">,</span> kContinue<span class=\"token punctuation\">,</span> kMultiply<span class=\"token punctuation\">,</span> kVerifyRegA <span class=\"token operator\">|</span> kVerifyRegB<span class=\"token punctuation\">)</span> \\</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token function\">V</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xB3</span><span class=\"token punctuation\">,</span> DIV_INT_2ADDR<span class=\"token punctuation\">,</span> <span class=\"token string\">\"div-int/2addr\"</span><span class=\"token punctuation\">,</span> k12x<span class=\"token punctuation\">,</span> kIndexNone<span class=\"token punctuation\">,</span> kContinue <span class=\"token operator\">|</span> kThrow<span class=\"token punctuation\">,</span> kDivide<span class=\"token punctuation\">,</span> kVerifyRegA <span class=\"token operator\">|</span> kVerifyRegB<span class=\"token punctuation\">)</span> \\</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token function\">V</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xE0</span><span class=\"token punctuation\">,</span> SHL_INT_LIT8<span class=\"token punctuation\">,</span> <span class=\"token string\">\"shl-int/lit8\"</span><span class=\"token punctuation\">,</span> k22b<span class=\"token punctuation\">,</span> kIndexNone<span class=\"token punctuation\">,</span> kContinue<span class=\"token punctuation\">,</span> kShl <span class=\"token operator\">|</span> kRegCFieldOrConstant<span class=\"token punctuation\">,</span> kVerifyRegA <span class=\"token operator\">|</span> kVerifyRegB<span class=\"token punctuation\">)</span> \\</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token function\">V</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xE1</span><span class=\"token punctuation\">,</span> SHR_INT_LIT8<span class=\"token punctuation\">,</span> <span class=\"token string\">\"shr-int/lit8\"</span><span class=\"token punctuation\">,</span> k22b<span class=\"token punctuation\">,</span> kIndexNone<span class=\"token punctuation\">,</span> kContinue<span class=\"token punctuation\">,</span> kShr <span class=\"token operator\">|</span> kRegCFieldOrConstant<span class=\"token punctuation\">,</span> kVerifyRegA <span class=\"token operator\">|</span> kVerifyRegB<span class=\"token punctuation\">)</span> \\<span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token function\">V</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xE2</span><span class=\"token punctuation\">,</span> USHR_INT_LIT8<span class=\"token punctuation\">,</span> <span class=\"token string\">\"ushr-int/lit8\"</span><span class=\"token punctuation\">,</span> k22b<span class=\"token punctuation\">,</span> kIndexNone<span class=\"token punctuation\">,</span> kContinue<span class=\"token punctuation\">,</span> kUshr <span class=\"token operator\">|</span> kRegCFieldOrConstant<span class=\"token punctuation\">,</span> kVerifyRegA <span class=\"token operator\">|</span> kVerifyRegB<span class=\"token punctuation\">)</span> \\</pre></td></tr></table></figure><p>æ”¹å˜ä¹˜é™¤ï¼Œæ”¹å˜ç§»ä½æ–¹å‘ã€‚<br />\nä¹Ÿå°±æ˜¯ <code>Java</code>  å±‚çš„ <code>XXTEA</code>  å·²ç»å®Œå…¨è¢«é­”æ”¹äº†ã€‚<br />\nå¯¹äºæ­¤å¤„çš„èŠ‚æ³•ï¼Œæˆ‘é¢„è®¡çš„æ­£è§£æ˜¯ <code>Hook</code>  ç¨‹åºåœ¨ <code>magic.toByteArray</code>  è§¦å‘å‰ï¼Œåœ¨ <code>Java</code>  å±‚ä½¿ç”¨ <code>Frida-dexdump</code>  è·å¾—é­”æ”¹åçš„å­—ç¬¦ä¸²ï¼Œæˆ–è€…è¯´æŠŠç¬¬äºŒæ¬¡ <code>strstr</code>  åçš„è¿˜åŸé€»è¾‘ <code>NOP</code>  æ‰ï¼Œåœ¨å‡ºé¢˜åæˆ‘ä¹Ÿå°è¯•è¿‡ï¼Œæ­¤æ³•å¯è¡Œï¼Œ <code>dump</code>  å‡ºçš„ <code>Dex</code>  å¸¦æœ‰å·²ä¿®æ”¹çš„å­—èŠ‚ç ï¼Œå¹¶ä¸”å¯ä»¥ç”¨ <code>Jeb</code>  åç¼–è¯‘ä¸º <code>Java</code>  ä»£ç ã€‚å½“ç„¶è¿˜å¯ä»¥ä½¿ç”¨ <code>Smali Trace</code>  æ¥æ‰“å° <code>Smali</code>  æ‰§è¡Œæµç¨‹ï¼Œå¯¹æ¯”å³å¯çŸ¥é“ä¿®æ”¹æµç¨‹ã€‚æ¯”èµ›ä¸­çš„å”¯ä¸€è§£ä½¿ç”¨çš„æ˜¯ CE æ–­ç‚¹ç„¶å <code>DUMP</code>  å†…å­˜è·å¾—ä¿®æ”¹åçš„ <code>Dex</code> ï¼Œèµ›åä¹Ÿæœ‰å¸ˆå‚…é€šè¿‡æ‰‹ä¿®å­—èŠ‚ç æ¥è·å¾—é­”æ”¹åçš„é€»è¾‘çš„ï¼Œéƒ½å¤ªå¼ºäº† <code>QAQ</code> ã€‚<br />\né­”æ”¹åçš„ <code>Java</code>  ä»£ç ç›´æ¥è´´å¸ˆå‚…ä»¬çš„å›¾äº†ã€‚<br />\n<img data-src=\"image-4.png\" alt=\"alt text\" /><br />\n <code>Flutter</code>  åŠ å¯†å®Œçš„ <code>AES</code>  å¯†æ–‡ä¼šè¢« <code>send</code>  åˆ° <code>Java</code>  è¿›è¡Œé­”æ”¹ XXTEAï¼Œæœ€åå¾—åˆ°åŠ å¯†ç»“æœæ¯”å¯¹éªŒè¯ï¼Œè‡³æ­¤å…¨éƒ¨ç¨‹åºéƒ½ç»“æŸäº†ã€‚</p>\n",
            "tags": [
                "Android",
                "æ±‡ç¼–",
                "Re"
            ]
        },
        {
            "id": "https://pangbai.work/IT/kali/",
            "url": "https://pangbai.work/IT/kali/",
            "title": "å¹²è´§ï¼å®‰å“æ‰‹æœºä¸Škali",
            "date_published": "2021-07-18T02:24:58.000Z",
            "content_html": "<h3 id=\"åœ¨ä½ çš„ä»»æ„å®‰å“æ‰‹æœºä¸Šåˆ·å…¥kali\"><a class=\"anchor\" href=\"#åœ¨ä½ çš„ä»»æ„å®‰å“æ‰‹æœºä¸Šåˆ·å…¥kali\">#</a>  <code>åœ¨ä½ çš„ä»»æ„å®‰å“æ‰‹æœºä¸Šåˆ·å…¥kali</code></h3>\n<p>åœ¨æ‰‹æœºä¸Šç¨³å®šä¾¿æ·è¿è¡Œ linux</p>\n<span id=\"more\"></span>\n<p>å¦‚æœä½ äº†è§£è¿‡ç½‘ç»œå®‰å…¨æ–¹é¢çš„çŸ¥è¯†ï¼Œé‚£ä½ ä¸€å®šä¼šå¬è¿‡ <code>Kali Linux </code> çš„åå­—</p>\n<p>å®ƒè¢«å¹¿æ³›ä½¿ç”¨äºç½‘ç»œæ”»å‡»ï¼Œä¸è¿‡åˆ†çš„è¯´ï¼Œå¤šå¹´æ¥ï¼Œè¿›æ”»å®‰å…¨ç³»ç»Ÿä¸€ç›´ä»¥ Kali Linux çš„ç³»ç»Ÿä¸»å¯¼å¸‚åœºã€‚<br />\nè€Œ <code>Kali Linux NetHunter</code>  åˆ™æ˜¯ä¸€æ¬¾é€‚ç”¨äº Android ç§»åŠ¨è®¾å¤‡çš„ Kali Linux æ¸—é€æµ‹è¯•ç³»ç»Ÿã€‚(ä½†ä»æ”»å‡»å·¥å…·çš„ä½¿ç”¨ä¸Šï¼ŒANDRAX ä¼¼ä¹æ¯”å·²ç»è¿‡æ—¶çš„å®ƒæ›´åŠ å¥½ç”¨)</p>\n<p>æˆ‘æ˜¯ä¸€ä¸ªé«˜ä¸­ç”Ÿï¼Œæ²¡æœ‰ä»€ä¹ˆå¾ˆå‰å®³ç­‰æƒ³æ³•ï¼Œä¹Ÿæ²¡æœ‰æƒ³è¿‡é»‘å®¢ä¹‹ç±»çš„ä¸œè¥¿ï¼Œåªæƒ³ç”¨æ‰‹æœºç©ç© linuxï¼Œçœ‹ç€æŒ‡ä»¤è¡Œï¼Œç”¨ç€ç”µè„‘çš„å›¾å½¢é¡µé¢å¾ˆæƒ¬æ„ã€‚æ‰‹æœºå·²ç» root è‡ªç„¶ä¸ç”¨å»æ termux äº†ï¼Œæˆ‘æŠŠç›®å…‰è½¬å‘ chrootã€‚äºæ˜¯å®‰è£…äº† <code>linuxdeploy</code> ï¼Œå®ƒå¯ä»¥é€‰æ‹©ä¸åŒçš„ linux å‘è¡Œç‰ˆä¸æ¶æ„ï¼Œéå¸¸å®Œç¾ï¼Œä½†æˆ‘ä¸è®¤ä¸ºå®ƒè¶³å¤Ÿç¨³å®šã€‚ä½¿ç”¨ç›®å½•å®‰è£…åŸºæœ¬åªä¼šå¤±è´¥ï¼Œè€Œä½¿ç”¨é•œåƒæ›´åŠ é¸¡è‚‹ã€‚ç»å¸¸æŒ‚è½½å¤±è´¥æ— æ³•å¯åŠ¨é•œåƒï¼Œä¸æ˜¯å®ä½“æ–‡ä»¶å¤¹ï¼Œéš¾å·²å¤‡ä»½æ•°æ®ï¼Œvnc å¯åŠ¨æ˜“æ­»ï¼Œåªè¦æœ‰äº›ä¸œè¥¿é”™è¯¯ï¼Œåªèƒ½å‰åŠŸå°½å¼ƒï¼Œç„¶åé‡æ–°å®‰è£… linuxï¼Œåˆç­‰ä¸ªä¸€ä¸ªå°æ—¶æŠŠä¹‹å‰çš„é‡æ–°åšä¸€éã€‚</p>\n<p>äºæ˜¯ï¼Œæˆ‘æƒ³åˆ°äº†ç›´æ¥åœ¨æ‰‹æœºä¸Šåˆ·å…¥ linux çš„æƒ³æ³•ï¼Œç„¶åå‘ç°äº† nethunterï¼Œèµ·åˆä»¥ä¸ºæˆ‘çš„æ‰‹æœºä¸æ”¯æŒè¿™ä¸œè¥¿ (åå•é‡Œä¼¼ä¹åªæœ‰ä¸€åŠ å’Œè°·æ­Œçš„äº²å„¿å­)ï¼Œé€›äº†å‡ ä¸ªåšå®¢å‘ç°ï¼Œæœ‰ä¸ªé€šåˆ·åŒ…ï¼Œåªæ˜¯ä¸èƒ½ä½¿ç”¨å¤–æ¥ç›‘å¬ç½‘å¡ã€‚å¾ˆæ¿€åŠ¨ï¼ŒèŠ±äº†å¾ˆæ—¶é—´çº¿ï¼Œæœ€åæˆåŠŸäº†ã€‚</p>\n<h1 id=\"åœ¨æ‰‹æœºä¸Šåˆ·å…¥kali\"><a class=\"anchor\" href=\"#åœ¨æ‰‹æœºä¸Šåˆ·å…¥kali\">#</a> åœ¨æ‰‹æœºä¸Šåˆ·å…¥ kali</h1>\n<p>æ¥ä¸‹æ¥è¿›å…¥ä¸»é¢˜ï¼Œå¦‚ä½•åœ¨å®‰å“æ‰‹æœºä¸Šåˆ·äºº Kali Linux NetHunter</p>\n<p><code>æ³¨: æœ¬ç¯‡æ–‡ç« ï¼Œåªç”¨äºæŠ€æœ¯äº¤æµï¼Œæ—¨åœ¨æ–¹ä¾¿chrootè¿è¡Œlinuxï¼Œä»»ä½•ä½¿ç”¨å·¥å…·ç…§æˆçš„åæœä¸æœ¬äººæ— å…³</code></p>\n<p>ä½œè€…:  <code>PangBai</code> <br />\n <code>è½¬è½½è¯·æ³¨æ˜æ¥æº</code></p>\n<p>å‡†å¤‡æ¡ä»¶</p>\n<ul>\n<li>ä¸€å°å·² root çš„æ‰‹æœº (å¸¦ twrp å°±ä¸ç”¨è¯´äº†)</li>\n<li>nethunter é€šåˆ·åŒ…</li>\n<li>ä¸€å®šçš„åˆ·æœºç»éªŒ</li>\n<li>å¤‡ä»½æ•°æ®å’Œæ•‘ç –å‡†å¤‡ (å…¶å®å¤±è´¥å‡ ç‡å¾ˆå°)</li>\n</ul>\n<h2 id=\"ä¸‹è½½kali-nethunter\"><a class=\"anchor\" href=\"#ä¸‹è½½kali-nethunter\">#</a> ä¸‹è½½ kali nethunter</h2>\n<p>è¿™é‡Œç»™å‡ºä¸‰ä¸ªåˆ·æœºåŒ…ï¼Œè¯·æ ¹æ®éœ€è¦é€‰æ‹©<br />\n arm 64 ä½æœ€æ–°ç‰ˆ<br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWFnZXMua2FsaS5vcmcvbmV0aHVudGVyL25ldGh1bnRlci0yMDIxLjItZ2VuZXJpYy1hcm02NC1rYWxpZnMtZnVsbC56aXA=\"> ARM64</span><br />\narm 32 ä½æœ€æ–°ç‰ˆ<br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWFnZXMua2FsaS5vcmcvbmV0aHVudGVyL25ldGh1bnRlci0yMDIxLjItZ2VuZXJpYy1hcm1oZi1rYWxpZnMtZnVsbC56aXA=\"> ARM32</span><br />\narm 32 ä½æ—§ç‰ˆ<br />\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly9idWlsZC5uZXRodW50ZXIuY29tL2luc3RhbGxlci9nZW5lcmljL3VwZGF0ZS1uZXRodW50ZXItZ2VuZXJpYy1hcm1oZi0yMDE3MTAwN18yMTUxNDYuemlw\"> ARM32</span><br />\n å¦‚æœä½ ä»…ä»…æƒ³å®‰è£…ä¸€ä¸ª linux è¯·é€‰æœ€åä¸€ä¸ªé“¾æ¥ï¼ŒåŒ…å¾ˆå°ï¼Œä½†å¾ˆå¤šç»„ä»¶æ˜¯æ—§çš„ (upgrade ç›´æ¥å‡ ä¸ª G ç»™ä½ åƒäº†ï¼Œè¿˜è€—äº†å‡ ä¸ªå°æ—¶)</p>\n<h2 id=\"å®‰è£…kali-nethunter\"><a class=\"anchor\" href=\"#å®‰è£…kali-nethunter\">#</a> å®‰è£… kali nethunter</h2>\n<p>æ‰‹æœºå…³æœºï¼Œå†æŒ‰å¼€æœºé”®å’ŒéŸ³é‡é”®ï¼Œè¿›å…¥ TWRP<br />\n<img data-src=\"http://shp.qpic.cn/collector/1642981619/678ec442-bfd7-4ef7-bd6c-13beb8f638c7/0\" alt=\"TWRPå›¾\" /><br />\næ»‘åŠ¨å…è®¸ä¿®æ”¹ç³»ç»Ÿ<br />\nç‚¹å‡»å³ä¸Šçš„æ¸…é™¤æŒ‰é’®ï¼Œ<br />\næ»‘åŠ¨æ¸…é™¤ (å…¶å®ä¹Ÿè®¸å¹¶ä¸æ˜¯ç‰¹åˆ«éœ€è¦)<br />\n è¿”å›ä¸»é¡µ<br />\nç‚¹å‡»å®‰è£…æŒ‰é’®<br />\né€‰æ‹©ä¹‹å‰ä¸‹è½½çš„ nethunter åŒ…<br />\nåˆ·å…¥<br />\nç­‰å¾…......(åŒ…è§£å‹æ—¶ä¼šè€—è´¹å¾ˆé•¿æ—¶é—´)<br />\n æœ€åæˆåŠŸ<br />\nå¯åŠ¨ç³»ç»Ÿ<br />\nå¼€æœºåŠ¨ç”»å¾ˆç‚«é…·ï¼Œå†…å¿ƒæ¿€åŠ¨ä¸å·²<br />\n<img data-src=\"http://shp.qpic.cn/collector/1642981619/11490d8f-43e1-4150-aa9a-a79e20095a39/0\" alt=\"nethunterå¼€æœºå›¾\" /><br />\nå¼€æœºåä¸åŸæ¥çš„æ‰‹æœºæ²¡æœ‰å·®åˆ«ï¼Œä¸€æ ·çš„é”å±ï¼Œæ¡Œé¢ï¼Œå®‰å“è½¯ä»¶<br />\nå”¯ä¸€ç‰¹æ®Šçš„æ˜¯å¤šäº†å‡ ä¸ªç‰¹åˆ«çš„ APP</p>\n<h2 id=\"é…ç½®\"><a class=\"anchor\" href=\"#é…ç½®\">#</a> é…ç½®</h2>\n<p>åˆ·å…¥çš„ kali ç³»ç»Ÿï¼Œç›®å½•åœ¨ /data/local/nhsystem/ ä¸‹é¢</p>\n<p>æ–°å¢çš„å®‰å“è½¯ä»¶æœ‰ä»¥ä¸‹å‡ ä¸ª<br />\n NetHunter      --&gt;kali ç³»ç»Ÿçš„æ§åˆ¶è½¯ä»¶<br />\n NetHunter ç»ˆç«¯  --&gt; å‘½ä»¤è¡Œæ‰§è¡Œè½¯ä»¶<br />\n Nethunter vnc  --&gt;vnc é“¾æ¥è½¯ä»¶<br />\n cSploit        --&gt; ç§»åŠ¨ç«¯ä¾¿æ·çš„ä¸€é”®æ¸—é€å·¥å…·<br />\n Hacker's keyboard --&gt; é”®ç›˜ï¼Œå¹¶ä¸å¥½ç”¨<br />\nè¿˜æœ‰ä¸€äº›æˆ‘ä¸çŸ¥é“ç”¨é€”</p>\n<p>é¦–å…ˆè¿›å…¥ nethunter ç»ˆç«¯ å¼¹å‡ºå¯¹è¯æ¡†<br />\nå¯ä»¥é€‰æ‹©å‘½ä»¤çš„æ‰§è¡Œç«¯ï¼Œæœæ–­é€‰ KALI</p>\n<p>apt update å‘ç°ï¼Ÿï¼Ÿä¸è¡Œï¼Œéœ€è¦æ¢æº<br />\nå»å®‰è£…ç›®å½•ä¸‹æ›´æ”¹ etc/apt/sources.list<br />\n æŠŠå†…å®¹å…¨éƒ¨æ¢æ‰</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"><span>sources.list</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>deb http<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>mirrors<span class=\"token punctuation\">.</span>ustc<span class=\"token punctuation\">.</span>edu<span class=\"token punctuation\">.</span>cn<span class=\"token operator\">/</span>kali kali<span class=\"token operator\">-</span>rolling main non<span class=\"token operator\">-</span>free contrib</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>deb<span class=\"token operator\">-</span>src http<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>mirrors<span class=\"token punctuation\">.</span>ustc<span class=\"token punctuation\">.</span>edu<span class=\"token punctuation\">.</span>cn<span class=\"token operator\">/</span>kali kali<span class=\"token operator\">-</span>rolling main non<span class=\"token operator\">-</span>free contrib</pre></td></tr></table></figure><p>ç„¶åè¿è¡Œ<br />\n apt update<br />\n å¦‚æœå¤±è´¥è¯·å»ç™¾åº¦æœç´¢æœ‰å…³æ•°å­—ç­¾åæ•™ç¨‹</p>\n<p>æ¥ä¸‹æ¥æ˜¯å¯åŠ¨ vnc å›¾å½¢é¡µé¢<br />\næ‰“å¼€ Nethunter<br />\n ç‚¹å‡» VNC Manager<br />\n ç‚¹å‡» SETUP LOCAL SERVER<br />\n è®¾ç½®å¯†ç <br />\nç„¶åè¾“å…¥ä»¥ä¸‹å¯åŠ¨æŒ‡ä»¤</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"><span>VNC </span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>export <span class=\"token constant\">USER</span><span class=\"token operator\">=</span>root</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>export <span class=\"token constant\">HOME</span><span class=\"token operator\">=</span><span class=\"token operator\">/</span>root</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>vncserver <span class=\"token operator\">-</span>kill <span class=\"token operator\">:</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>rm <span class=\"token operator\">-</span>rf <span class=\"token operator\">/</span>tmp<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token constant\">X1</span><span class=\"token operator\">-</span>lock</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>rm <span class=\"token operator\">-</span>rf <span class=\"token operator\">/</span>tmp<span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token constant\">X11</span><span class=\"token operator\">-</span>unix<span class=\"token operator\">/</span><span class=\"token constant\">X1</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>vncserver <span class=\"token operator\">-</span>name remote<span class=\"token operator\">-</span>desktop <span class=\"token operator\">:</span><span class=\"token number\">1</span></pre></td></tr></table></figure><p>æ‰“å¼€ VNC é“¾æ¥è½¯ä»¶ (æ¨èå»ä¸‹è½½ç¬¬ä¸‰æ–¹çš„ vncï¼Œnethunter vnc ä¸å¥½ç”¨)<br />\n åœ°å€: 127.0.0.1:5901<br />\n è´¦å·: root<br />\n å¯†ç ï¼šä½ è®¾ç½®çš„å¯†ç </p>\n<p>ç„¶åçœ‹åˆ°äº†ç†Ÿæ‚‰çš„æ¡Œé¢<br />\n<img data-src=\"https://shp.qpic.cn/collector/1642981619/32a2cfd6-51e7-4fd4-ab14-e6df705e084a/0\" alt=\"kaliæ¡Œé¢\" /></p>\n",
            "tags": [
                "linux",
                "kail",
                "æ¸—é€",
                "Android"
            ]
        },
        {
            "id": "https://pangbai.work/IT/Nowork/dialog/",
            "url": "https://pangbai.work/IT/Nowork/dialog/",
            "title": "Androidåº•éƒ¨ç®€çº¦é£æ ¼å¯¹è¯æ¡†",
            "date_published": "2021-06-19T05:39:19.000Z",
            "content_html": "<p>åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œçº ç»“äºå¯¹è¯æ¡†çš„åˆ¶ä½œï¼Œå„ç§åšå®¢ä¸Š Android å¯¹è¯æ¡†çš„åˆ¶ä½œæ•™ç¨‹å¾ˆå¤šï¼Œåœ¨æ­¤è®°å½•ä¸‹è‡ªå·±åˆ¶ä½œå¯¹è¯æ¡†è¯¦ç»†çš„è¿‡ç¨‹ã€‚</p>\n<span id=\"more\"></span>\n<p>åœ¨å®‰å“å¼€å‘ä¸­ï¼Œè½¯ä»¶æ•´ä½“ UI æ˜¯å¦èµå¿ƒæ‚¦ç›®å†³å®šäº†ç”¨æˆ·å¯¹è¿™ä¸ªè½¯ä»¶çš„è¯„ä»·ï¼Œè€Œå¯¹è¯æ¡†æ˜¯ç”¨å¼¹å‡ºçš„æ§ä»¶æé†’ç”¨æˆ·æ“ä½œçš„å·¥å…·ï¼Œè¯´æ˜¯ APP çš„é¢å­ä¹Ÿä¸è¿‡åˆ†<br />\næˆ‘æ›¾ç»åœ¨å¾ˆå¤šç®€çº¦é£æ ¼è½¯ä»¶ä¸­çœ‹è§è¿‡åœ†è§’çš„åº•éƒ¨å¯¹è¯æ¡†ï¼Œä¾¿æ„Ÿè§‰åˆ°äº†è¿™ç§é£æ ¼çš„ç¾ä¸½ã€‚ä¾¿ä¸€ç›´æƒ³å®ç°å®ƒï¼Œä¾¿åœ¨ç½‘ä¸Šç¿»æ‰¾æ•™ç¨‹ï¼Œä½†å¤§å¤šéƒ½æ˜¯å¤šäº†äº›å¤æ‚ï¼Œè€Œä¸”æè¿°å¹¶ä¸æ¸…æ™°ï¼Œå¯¹äºæˆ‘è¿™ç§å°ç™½ï¼Œæ›´å¤šå¸¦æ¥çš„æ˜¯å¤´ç–¼ï¼Œç»è¿‡æŸ¥æ‰¾èµ„æ–™ï¼Œç»ˆäºæ¸…æ™°äº†å®ç°è¿™ç§å¯¹è¯æ¡†çš„æ–¹æ³•ã€‚<br />\nå¯¹è¯æ¡†å¯ä»¥é€‰æ‹© <code>Dialog</code>  æˆ–è€… v7 åŒ…é‡Œçš„  <code>Alertdialog</code> ï¼Œä½¿ç”¨æ–¹æ³•å’Œæ•ˆæœéƒ½å·®ä¸å¤ªå¤š<br />\nå»ºè®®ä½¿ç”¨ Dialogï¼Œæ¯”èµ· v7 åŒ…çš„é‚£ä¸€å¤§å †ä¸œè¥¿ï¼Œæˆ‘æ›´å–œæ¬¢  <code>Dialog</code> <br />\n è¿™é‡Œå°†è¦ç”¨åˆ°çš„æ–‡ä»¶æœ‰</p>\n<ul>\n<li>a.java : ä¸€ä¸ª Activity</li>\n<li>bottomdialog.xml : å¯¹è¯æ¡†çš„å¸ƒå±€æ–‡ä»¶</li>\n<li>translate_dialog_in.xml : å¯¹è¯æ¡†è¿›å…¥åŠ¨ç”»</li>\n<li>translate_dialog_out.xml : å¯¹è¯æ¡†å…³é—­åŠ¨ç”»</li>\n</ul>\n<p>é¦–å…ˆè¦è®¾ç½®å¯¹è¯æ¡†æ ·å¼ï¼Œæ‰¾åˆ°é¡¹ç›®ä¸­ value æ–‡ä»¶å¤¹é‡Œçš„  <code>style.xml</code>  å¹¶åœ¨å…¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç </p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"><span>style.xml</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>BottomDialog<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">parent</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@android:style/Theme.Dialog<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>item</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android:windowContentOverlay<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>@null<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>item</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token comment\">&lt;!-- æµ®äº Activity ä¹‹ä¸Š --></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>item</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android:windowIsFloating<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>item</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre> <span class=\"token comment\">&lt;!-- è¾¹æ¡† --></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>item</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android:windowFrame<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>@null<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>item</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token comment\">&lt;!-- Dialog ä»¥å¤–çš„åŒºåŸŸæ¨¡ç³Šæ•ˆæœ --></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>item</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android:backgroundDimEnabled<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>item</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre> <span class=\"token comment\">&lt;!-- æ— æ ‡é¢˜ --></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>item</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android:windowNoTitle<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>item</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">&lt;!-- åŠé€æ˜ --></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>item</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android:windowIsTranslucent<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>item</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>item</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android:windowBackground<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>@android:color/transparent<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>item</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">&lt;!-- å¯¹è¯æ¡†åŠ¨ç”» --></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>BottomDialog.Animation<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">parent</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@android:style/Animation.Dialog<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>item</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android:windowEnterAnimation<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>@anim/translate_dialog_in<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>item</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>item</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>android:windowExitAnimation<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>@anim/translate_dialog_out<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>item</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>åœ¨ res ä¸­æ·»åŠ  anim æ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾åŠ¨ç”»<br />\nåœ¨æ–‡ä»¶å¤¹ä¸­æ·»åŠ  translate_dialog_in.xml å’Œ translate_dialog_out.xml</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"><span>translate_dialog_in.xml</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>resources</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>translate</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>android</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://schemas.android.com/apk/res/android<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>duration</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>300<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>fromXDelta</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>fromYDelta</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>toXDelta</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>toYDelta</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>100%<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>translate</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>resources</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><figure class=\"highlight xml\"><figcaption data-lang=\"XML\"><span>translate_dialog_out.xml</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>resources</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>translate</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>android</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://schemas.android.com/apk/res/android<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>duration</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>300<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>fromXDelta</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>fromYDelta</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>toXDelta</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>toYDelta</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>100%<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>translate</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>resources</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æŒ‰ç…§ä½ è‡ªå·±çš„éœ€è¦åˆ¶ä½œåº•éƒ¨å¯¹è¯æ¡†å¸ƒå±€<br />\næˆ‘çš„æ˜¯è¿™æ ·çš„</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"><span>bottomdialog.xml</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>LinearLayout</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>android</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://schemas.android.com/apk/res/android<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>orientation</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>vertical<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>match_parent<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_gravity</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>center<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_margin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0dp<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>padding</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0dp<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>background</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@drawable/dialog_bg<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>LinearLayout</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>orientation</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>horizontal<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>match_parent<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>gravity</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>left<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_marginLeft</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20dp<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_marginRight</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20dp<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_marginTop</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20dp<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>TextView</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>text</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>nowork<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>textSize</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>18sp<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>textStyle</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>bold<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>textColor</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>#ff000000<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_gravity</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>center<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_marginLeft</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>5dp<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@+id/dtv1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>LinearLayout</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>LinearLayout</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>orientation</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>horizontal<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>match_parent<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>gravity</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>left<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_marginLeft</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20dp<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_marginRight</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20dp<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_marginBottom</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20dp<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_marginTop</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20dp<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>TextView</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>text</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>æ— <span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>textSize</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>17sp<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@+id/dtv2<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>textColor</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>#FF312E2E<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>LinearLayout</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>LinearLayout</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>orientation</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>horizontal<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>match_parent<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_marginLeft</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>25dp<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_marginRight</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>25dp<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>LinearLayout</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>orientation</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>horizontal<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>45dp<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_weight</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>5<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_marginRight</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>15dp<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>background</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@drawable/bdyj<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_marginBottom</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10dp<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@+id/dlv3<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>gravity</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>center<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>\t\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>TextView</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>\t\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>\t\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>\t\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>text</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>å–æ¶ˆ<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>\t\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>textSize</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>19sp<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>\t\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>textColor</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>#FF312E2E<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>LinearLayout</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>LinearLayout</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>orientation</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>horizontal<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>45dp<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_weight</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>5<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_marginLeft</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>15dp<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>background</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@drawable/bdyj<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_marginBottom</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10dp<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@+id/dlv4<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>gravity</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>center<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>\t\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>TextView</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>\t\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>\t\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>layout_height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>wrap_content<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>\t\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>text</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ç¡®å®š<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>\t\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>textSize</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>19sp<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>\t\t\t\t<span class=\"token attr-name\"><span class=\"token namespace\">android:</span>textColor</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>#FF312E2E<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>LinearLayout</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>LinearLayout</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre></pre></td></tr><tr><td data-num=\"103\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>LinearLayout</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>æœ€ååªæœ‰åœ¨Activityä»£ç é‡Œè°ƒç”¨å¯¹è¯æ¡†</pre></td></tr><tr><td data-num=\"106\"></td><td><pre>```java a.java</pre></td></tr><tr><td data-num=\"107\"></td><td><pre></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>      Dialog bottomDialog = new Dialog(a.this, R.style.BottomDialog);</pre></td></tr><tr><td data-num=\"109\"></td><td><pre>      //æŒ‡å®šå¸ƒå±€</pre></td></tr><tr><td data-num=\"110\"></td><td><pre>View contentView = LayoutInflater.from(a.this).inflate(R.layout.bottomdialog, null);</pre></td></tr><tr><td data-num=\"111\"></td><td><pre>bottomDialog.setContentView(contentView);</pre></td></tr><tr><td data-num=\"112\"></td><td><pre>ViewGroup.LayoutParams layoutParams = contentView.getLayoutParams();</pre></td></tr><tr><td data-num=\"113\"></td><td><pre>layoutParams.width = getResources().getDisplayMetrics().widthPixels;</pre></td></tr><tr><td data-num=\"114\"></td><td><pre>contentView.setLayoutParams(layoutParams);</pre></td></tr><tr><td data-num=\"115\"></td><td><pre>//æ§åˆ¶å¯¹è¯æ¡†ä½ç½®</pre></td></tr><tr><td data-num=\"116\"></td><td><pre>bottomDialog.getWindow().setGravity(Gravity.BOTTOM);</pre></td></tr><tr><td data-num=\"117\"></td><td><pre>bottomDialog.getWindow().setWindowAnimations(R.style.BottomDialog_Animation);</pre></td></tr><tr><td data-num=\"118\"></td><td><pre>//æ˜¾ç¤ºå¯¹è¯æ¡†</pre></td></tr><tr><td data-num=\"119\"></td><td><pre>bottomDialog.show();</pre></td></tr></table></figure><p>ä»¥ä¸‹æ˜¯æˆå“<br />\n<img data-src=\"http://shp.qpic.cn/collector/1642981619/d9076b1b-c52c-4d30-a834-5012ee76d3a1/0\" alt=\"image\" title=\"æ»‘ç¨½\" /></p>\n",
            "tags": [
                "Android"
            ]
        }
    ]
}