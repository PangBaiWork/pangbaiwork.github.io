---
title: 常见加密算法特征识别
categories: CTF
tags:
- Re
- 汇编
---
总结一下常见的加密算法特征，不然看一堆代码也想不起来是什么加密
<!--more-->
# Tea系列
tea系列加密可谓常见，甚至腾讯都在魔改tea使用到数据加密中。
Tea系列加密都会有个叫Delta的东西，其常见值为`0x9E3779B9或0x61C88647`，这个东西是可以被随意改变的，但是如果见得这串熟悉的数据，那就基本可以确定是tea系列加密了
## Tea
普通tea可以被攻击(别问怎么攻击，我也不知道)
每次加密处理64位数据，并且被分别两组
 - [ ] 明显的两行进行一堆位运算和异或后与明文相加减
 - [ ]  Dword[2] 或者两个Dword进行操作,
 - [ ] 循环32次，但是这个次数是魔改的
 - [ ] 移位通常是左移4，右移5，这个也是可以魔改的
 - [ ] Key是4个32位的值,与移位后数据相加
 
## XTEA/TEAN
可以被攻击，特征与TEA相似，但还比tea多一个特征
 - [ ] 对Delta的和进行&3来选取密钥
## XXTEA
最厉害的tea类型加密，加密逻辑比较复杂，不像上面两个看两眼就能写解密代码，同时原字符串长度可以不是4的倍数了，特征和上面两个也很不一样
 - [x] 128位的key(和上面两个一样)
 - [x] 很多的&3操作，会和key和sum进行运算
 - [x] 嵌套循环
 - [x] 可能会在同一行里出现左移2或4，右移3或5(你就记2345吧)
 - [x] rounds = 6 + 52/n,会出现被除数52和+6
```cpp
unsigned int v[8] = {0x10BD3B47, 0x6155E0F9, 0x6AF7EBC5, 0x8D23435F, 0x1A091605, 0xD43D40EF, 0xB4B16A67, 0x6B3578A9};
    unsigned int key[4] = {0x00001234, 0x00002345, 0x00004567, 0x00006789};
    unsigned int sum = 0;
    unsigned int y,z,p,rounds,e;
    int n = 8;
    int i = 0;
    rounds = 6 + 52/n;
    y = v[0];
    sum = rounds*delta;
     do
     {
        e = sum >> 2 & 3;
        for(p=n-1;p>0;p--)
        {
            z = v[p-1];
            v[p] -= ((((z>>5)^(y<<2))+((y>>3)^(z<<4))) ^ ((key[(p&3)^e]^z)+(y ^ sum)));
            y = v[p];
        }
        z = v[n-1];
        v[0] -= (((key[(p^e)&3]^z)+(y ^ sum)) ^ (((y<<2)^(z>>5))+((z<<4)^(y>>3))));
        y = v[0];
        sum = sum-delta;
     }while(--rounds);
```

# AES加密
AES为对称加密，同时也是分组加密，每组处理128位数据(16个字节)，按密钥长度分为AES128(16字节密钥10轮加密),AES192(24字节密钥12轮加密),AES256(32字节密钥14轮加密)。
 - [x] 对明文长度进行除16，或者右移4位
 - [x] 左移右移24/16/8或者&ff000000，&00ff0000，&0000ff00，&000000ff
 - [x] 256个元素的数组(16x16的Sbox)，如加密盒子{0x63,0x7c,0x77,0x7b...}解密盒子{0x52,0x09,0x6a,0xd5...},可能出现换盒
 - [x] 一行代码里对数组4个元素操作(看起来很整齐，元素下标有顺序)
_加密可以魔改，subbytes和shiftrows顺序调换是没关系的，但是MixColums顺序加密放最前面解密就要放最后面_
 
# sha1
不安全的加密算法，不可逆
- [x] 一般有5个IV  0x67452301;0xEFCDAB89;0x98BADCFE;0x10325476;0xC3D2E1F0(前四个和md的iv相同)
- [x] 

# BlowFish
两个盒用来加密
- [x] PBOX(18个32位子密钥)
- [x] SBOX(4组8*32位数组Sbox[4][256])
- [x] 18轮循环里套4轮循环,4轮循环里套256(步长为2)轮循环
# sm4(国密)
分组加密，和AES特征很像。
- [x] 256个元素的SBOX
- [x] 128位分组，密钥也是128位(16字节)
- [x] 移位8，16，24再&ff
- [x] 一行代码里对数组4个元素操作(看起来很整齐，元素下标有顺序)
# rc4加密
加密解密是同一套算法
- [x] 一个256位的sbox
- [x] 进行变量数值交换操作(swap)
- [x] 多次取余256
- [x] 一个单独的异或操作

# DES加密
主要加密特征是一堆表
- [x] 64位(8字符)或192位(24字符)的key
- [x] 16个元素的移位数组
- [x] 32个元素的换位表
- [x] 48个元素选位表
- [x] 56个元素的选位数组
- [x] 64个元素的置换表
- [x] 8x4x16(512)个元素的sbox
# base58
和普通base加密有很大不同，通过取模就行加密
- [x] 进行%58和/58的操作