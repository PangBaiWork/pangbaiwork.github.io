<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>ğ•ºğ–šğ–— ğ•·ğ–ğ–‹ğ–Š â€¢ Posts by &#34;frida&#34; category</title>
        <link>https://pangbai.work</link>
        <description>è®°å½•ç”Ÿæ´» | ä¸ºä¼—äººæŠ±è–ªè€…,ä¸å¯ä½¿å…¶æ‰¼äºé£é›ª</description>
        <language>zh-CN</language>
        <pubDate>Thu, 03 Jul 2025 16:13:19 +0800</pubDate>
        <lastBuildDate>Thu, 03 Jul 2025 16:13:19 +0800</lastBuildDate>
        <category>Linux</category>
        <category>shell</category>
        <category>IT</category>
        <category>ç¼–ç¨‹</category>
        <category>æ±‡ç¼–è¯­è¨€</category>
        <category>ADB</category>
        <category>re</category>
        <category>Dowork</category>
        <category>Github</category>
        <category>linux</category>
        <category>kail</category>
        <category>æ¸—é€</category>
        <category>Android</category>
        <category>å®‰å“</category>
        <category>åšå®¢æ—¥å¸¸</category>
        <category>è®°å½•ç”Ÿæ´»</category>
        <category>æ°µå¸–</category>
        <category>Minecraft</category>
        <category>æœåŠ¡å™¨</category>
        <category>xposed</category>
        <category>xpæ¨¡å—</category>
        <category>å¤ªæ</category>
        <category>icebox</category>
        <category>æ‰‹æœºè½¯ä»¶åˆ†äº«</category>
        <category>çº¿ç¨‹ä¸‹è½½å™¨</category>
        <category>æ±‡ç¼–</category>
        <category>MC</category>
        <category>Re</category>
        <category>frida</category>
        <category>åè°ƒè¯•</category>
        <category>STM32</category>
        <category>htmlå‰ç«¯</category>
        <item>
            <guid isPermalink="true">https://pangbai.work/CTF/Reverse/frida-check/</guid>
            <title>Fridaç‰¹å¾åˆ†æ(åŸºäºå»ç‰¹å¾çš„FridaServer)</title>
            <link>https://pangbai.work/CTF/Reverse/frida-check/</link>
            <category>æ±‡ç¼–</category>
            <category>Re</category>
            <category>åè°ƒè¯•</category>
            <pubDate>Thu, 03 Jul 2025 16:13:19 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;Frida æ˜¯å®‰å“é€†å‘åˆ†æçš„åˆ©å™¨ï¼Œæ³¨å…¥æ£€æµ‹ä¸€ç›´æ˜¯å¯¹æŠ—çš„éš¾é¢˜ï¼Œå­¦ä¼šè§£å†³è¿™äº›é—®é¢˜æ‰èƒ½æˆä¸ºä¸€ä¸ªçœŸæ­£çš„é€†å‘å·¥ç¨‹å¸ˆã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;å°±åŸæœ¬çš„æ„å»ºçš„ frida è€Œè¨€ï¼Œæ³¨å…¥æ£€æµ‹æ˜¯ååˆ†ç®€å•çš„ï¼Œä» &lt;code&gt;/proc/self/maps&lt;/code&gt; ï¼Œä» &lt;code&gt;/proc/self/stat&lt;/code&gt; ï¼Œéƒ½å¯ä»¥æ‰¾åˆ°å¾ˆå¤š Frida æ³¨å…¥ç‰¹å¾ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä¸ªäººæ—¥å¸¸ä½¿ç”¨çš„é­”æ”¹ Frida æ˜¯&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1lsYXJvZC9GbG9yaWRhL3JlbGVhc2Vz&#34;&gt; Florida&lt;/span&gt;ï¼Œè¿™é‡Œæ„Ÿè°¢ä¸€ä¸‹ä½œè€…ï¼Œä½¿ç”¨ &lt;code&gt;GitHub Action&lt;/code&gt;  æŒç»­æ„å»ºæœ€æ–°çš„ &lt;code&gt;release&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è¿è¡Œæ—¶æ£€æµ‹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#è¿è¡Œæ—¶æ£€æµ‹&#34;&gt;#&lt;/a&gt; è¿è¡Œæ—¶æ£€æµ‹&lt;/h3&gt;
&lt;p&gt;å¯¹äº inline hook åœ¨å·¥ä½œæ—¶ä¸€å®šä¼šä¿®æ”¹æ±‡ç¼–ä»£ç ï¼Œcrc å¿«é€Ÿæ ¡éªŒ text ç«¯æ˜¯å¾ˆæœ‰æ•ˆçš„æ‰‹æ®µï¼Œä½†æ˜¯ä¼šå¸¦æ¥ä¸€å®šæ€§èƒ½æŸå¤±ã€‚æœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ³•æ£€æµ‹ frida å‘¢ï¼Ÿæœ‰çš„ã€‚&lt;/p&gt;
&lt;h4 id=&#34;prettymethod&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#prettymethod&#34;&gt;#&lt;/a&gt; PrettyMethod&lt;/h4&gt;
&lt;p&gt;Frida å¯ä»¥åŒæ—¶ hook java å’Œ native ä»£ç ï¼Œå…¶ä¸­çš„ java ä»£ç  hook æ˜¯é€šè¿‡ hook libart å®ç°çš„ï¼Œå…¶ä¸­ &lt;code&gt;art::ArtMethod::PrettyMethod&lt;/code&gt;  ä¸€å®šä¼šè¢« frida ä¿®æ”¹ã€‚æ¯”èµ· crc æ ¡éªŒ so çš„æ•´ä¸ª text æ®µï¼Œä¸å¦‚ç›´æ¥æ ¡éªŒ &lt;code&gt;PrettyMethod&lt;/code&gt;  çš„å‡½æ•°å‰å‡ ä¸ªå­—èŠ‚ï¼Œè§£æ &lt;code&gt;PrettyMethod&lt;/code&gt;  æ±‡ç¼–ä»£ç å‰å‡ è¡Œï¼Œå¦‚æœæœ‰   &lt;code&gt;br 0x*****&lt;/code&gt;  ç±»å‹çš„é•¿è·³è½¬ä¹Ÿè¯´æ˜è¢« frida æ³¨å…¥äº†ã€‚Frida å¯åŠ¨æ—¶ä¸æ­¢è¿™ä¸€ä¸ª &lt;code&gt;native lib&lt;/code&gt;  è¢« &lt;code&gt;Hook&lt;/code&gt; ï¼Œåƒ &lt;code&gt;libc.so&lt;/code&gt;  è¿™ç§åº“çš„å¯¼å‡ºå‡½æ•°ä¹Ÿä¼šå­˜åœ¨ç›¸ä¼¼çš„ç‰¹å¾ã€‚&lt;br /&gt;
è¿˜æœ‰ä¸€ç§è¿è¡Œæ—¶æ£€æµ‹æ˜¯å †æ ˆæ£€æŸ¥ï¼Œæ£€æŸ¥å‡½æ•°è°ƒç”¨çš„å †æ ˆä¿¡æ¯ï¼Œå¦‚æœæœ‰å¼‚å¸¸æƒ…å†µä¹Ÿå¯ä»¥è¯´æ˜è¢« hook äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åŸºäº-proc-æ¥å£çš„æ£€æµ‹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#åŸºäº-proc-æ¥å£çš„æ£€æµ‹&#34;&gt;#&lt;/a&gt; åŸºäº /proc æ¥å£çš„æ£€æµ‹&lt;/h3&gt;
&lt;h4 id=&#34;æ˜æ˜¾å­—ç¬¦ä¸²æ£€æµ‹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æ˜æ˜¾å­—ç¬¦ä¸²æ£€æµ‹&#34;&gt;#&lt;/a&gt; æ˜æ˜¾å­—ç¬¦ä¸²æ£€æµ‹&lt;/h4&gt;
&lt;p&gt;åŸºäº &lt;code&gt;/proc&lt;/code&gt;  çš„æ£€æŸ¥è¢«å¤§å‚ä½¿ç”¨å¾—æ›´å¹¿æ³›ï¼Œå³ä½¿æ˜¯é­”æ”¹ &lt;code&gt;Frida&lt;/code&gt;  ä¹Ÿå¯ä»¥è¢«æ£€æµ‹å‡º &lt;code&gt;Frida&lt;/code&gt;  ç‰¹å¾ï¼Œè¿™é‡Œæ‹¿ &lt;code&gt;BiliBili&lt;/code&gt;  çš„ &lt;code&gt;libmsaoaidsec.so&lt;/code&gt;  æ¥è¯´å§ï¼ˆä¸åªæ˜¯ b ç«™ï¼Œè¿™ä¸ª so è¢«éå¸¸å¤šçš„ &lt;code&gt;app&lt;/code&gt;  ä½¿ç”¨ï¼‰ã€‚&lt;br /&gt;
è¿™ä¸ª so åœ¨åŠ è½½æ—¶ä¼šè°ƒç”¨ &lt;code&gt;.init_proc&lt;/code&gt;  çš„åˆå§‹åŒ–å‡½æ•°ï¼Œå…¶ä¸­ä¸€æ®µä»£ç &lt;img data-src=&#34;image.png&#34; alt=&#34;dlsym&#34; /&gt; åŠ¨æ€è§£æ libc è·å¾— pthread_create çš„åœ°å€ï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°åˆ›å»ºäº†ä¸‰ä¸ªçº¿ç¨‹ï¼Œå¾ªç¯æ£€æµ‹ Frida ç‰¹å¾ï¼Œå…¶ä¸­ä¸€ä¸ªçº¿ç¨‹åœ¨éå† &lt;code&gt;/proc/self/task&lt;/code&gt; ï¼Œè¿™ä¸ªç›®å½•åŒ…å«å½“å‰è¿›ç¨‹æ‰€æœ‰çº¿ç¨‹çš„è¿è¡Œä¿¡æ¯ï¼Œè¯»å– &lt;code&gt;/proc/self/task/tid/status&lt;/code&gt;  æ–‡ä»¶å†…å®¹ &lt;img data-src=&#34;image-1.png&#34; alt=&#34;alt text&#34; /&gt; å†…å®¹åŒ…å«çº¿ç¨‹åç§°ï¼Œé€šè¿‡ &lt;code&gt;strstr&lt;/code&gt;  åˆ¤æ–­çº¿ç¨‹åç§°æ˜¯ä¸æ˜¯åŒ…å« &lt;code&gt;gum-js-loop&lt;/code&gt;  å’Œ &lt;code&gt;gmain&lt;/code&gt;  æ¥æ£€æµ‹ fridaï¼Œæ£€æµ‹æˆåŠŸå°±ä¼šé—ªé€€ã€‚&lt;br /&gt;
&lt;img data-src=&#34;image-2.png&#34; alt=&#34;alt text&#34; /&gt;&lt;br /&gt;
 é­”æ”¹ç‰¹å¾çš„ &lt;code&gt;Florida&lt;/code&gt;  å¹¶æ²¡æœ‰é€šè¿‡è¿™ä¸€æ£€æµ‹ã€‚&lt;br /&gt;
ä¸åªæ˜¯ &lt;code&gt;status&lt;/code&gt; ï¼Œapp è¿˜å¯ä»¥æ£€æŸ¥ &lt;code&gt;/proc/self/task/tid/stat&lt;/code&gt;   &lt;code&gt;/proc/self/task/tid/sched&lt;/code&gt;   &lt;code&gt;/proc/self/task/tid/comm&lt;/code&gt;  ç­‰å¤šä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶å†…å®¹ï¼Œéƒ½å¯ä»¥æ£€æµ‹å‡ºæ˜æ˜¾çš„ frida çš„ç‰¹å¾ã€‚&lt;br /&gt;
æœ€åè¿˜æœ‰ä¸ªååˆ†å®¹æ˜“æ£€æµ‹çš„ç‰¹å¾æ˜¯ &lt;code&gt;/proc/self/net/unix&lt;/code&gt; , è¢« frida æ³¨å…¥æ—¶ä¼šåŒ…å«å¦‚ä¸‹å†…å®¹&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;0000000000000000: 00000003 00000000 00000000 0001 03 &lt;span class=&#34;token number&#34;&gt;1741108&lt;/span&gt; @/frida-e254654d-8ae6-4a50-9764-e54a961a9439&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;ç”¨äºé€šä¿¡çš„ frida çš„ &lt;code&gt;unix&lt;/code&gt;  åŸŸå¥—æ¥å­—ã€‚&lt;/p&gt;
&lt;h4 id=&#34;åˆ†æç‰¹å¾çš„æ£€æµ‹&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#åˆ†æç‰¹å¾çš„æ£€æµ‹&#34;&gt;#&lt;/a&gt; åˆ†æç‰¹å¾çš„æ£€æµ‹&lt;/h4&gt;
&lt;p&gt;é‡ç¾åŒºè¿˜æ˜¯ &lt;code&gt;/proc/self/maps&lt;/code&gt; ï¼Œæœ€ä¼ ç»Ÿçš„æ£€æµ‹å°±æ˜¯ &lt;code&gt;frida-agent-64.so&lt;/code&gt; ï¼Œä½†æ˜¯è¿™ä¸ªç‰¹å¾å¾ˆå®¹æ˜“å»é™¤ã€‚å‰é¢æœ‰è°ˆåˆ° &lt;code&gt;libc.so&lt;/code&gt;  ä¼šè¢« &lt;code&gt;Hook&lt;/code&gt; ï¼Œè¿™ç‚¹ä» &lt;code&gt;/proc/self/maps&lt;/code&gt;  ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œæƒé™çš„ä¿®æ”¹æ˜¯è¦ç¬¦åˆå†…å­˜é¡µçš„ï¼Œä¿®æ”¹å­—èŠ‚ç ä¼šå¯¼è‡´ &lt;code&gt;maps&lt;/code&gt;  ä¸­å‡ºç°ä¸¤ä¸ª &lt;code&gt;xp&lt;/code&gt;  æƒé™çš„æ®µä¸­é—´å‡ºç°è‹¥å¹²ä¸ª &lt;code&gt;rwxp&lt;/code&gt;  æƒé™çš„å†…å­˜æ®µï¼Œæ­£å¸¸æƒ…å†µä¸‹ &lt;code&gt;xp&lt;/code&gt;  çš„æ®µåº”è¯¥æ˜¯å®Œæ•´çš„å¹¶ä¸”åªæœ‰ä¸€ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;æ£€æµ‹æ–¹æ³•å¾ˆå¤šï¼Œåæ£€æµ‹æ–¹æ³•å…¶å®ä¹Ÿå¯ä»¥å¾ˆå¤šã€‚&lt;br /&gt;
æœ‰è¡¥å……æˆ–è€…å‹˜è¯¯çš„å°ä¼™ä¼´å¯ä»¥åœ¨è¯„è®ºåŒºç•™è¨€ã€‚&lt;/p&gt;
 ]]></description>
        </item>
    </channel>
</rss>
